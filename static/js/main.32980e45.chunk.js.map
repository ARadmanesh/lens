{"version":3,"sources":["utils/i18n.js","utils/theme.js","navigation.js","utils/countries.js","text.js","prolific.js","matrix.js","submission.js","bart.js","gonogo.js","utils/random.js","utils/shuffle.js","stroop.js","components/allotmentBox.js","ultimatum.js","dictator.js","taskswitch.js","simplified_taskswitch.js","nback.js","gonogoalt.js","study.js","about.js","language_selector.js","router.js","index.js"],"names":["languages","title","direction","i18n","use","Backend","initReactI18next","init","lng","fallbackLng","debug","process","keySeparator","backend","loadPath","darkTheme","createMuiTheme","palette","type","primary","main","secondary","typography","fontFamily","join","rtlDarkTheme","ltrTheme","responsiveFontSizes","rtlTheme","Navigation","_ref","finished","redirectTo","onNext","t","useTranslation","_jsx","Grid","container","justifyContent","children","_jsxs","item","Button","variant","color","onClick","href","countries","code","label","phone","suggested","Text","content","onStore","onValidate","response","useRef","_useState","useState","value","_useState2","_slicedToArray","state","setState","useEffect","_response$current","current","handleChange","e","_objectSpread","resp","console","log","undefined","length","CountryAutoComplete","Autocomplete","id","options","autoHighlight","onChange","v","getOptionLabel","option","noOptionsText","renderOption","Fragment","isoCode","String","fromCodePoint","toUpperCase","replace","char","charCodeAt","renderInput","params","TextField","inputProps","autoComplete","className","spacing","alignItems","Markdown","source","text","escapeHtml","instruction","placeholder","fullWidth","target","Prolific","_content$content","query","URLSearchParams","useLocation","search","_content$paramNameAsC","fieldContent","getUrlContent","paramNameAsContent","get","defaultValue","ValueLabelComponent","props","open","Tooltip","enterTouchDelay","placement","arrow","Matrix","questions","choices","slider","showMidMark","values","Array","from","requiredQuestions","window","scrollTo","top","behavior","renderSlider","index","xs","Slider","valueLabelFormat","onChangeCommitted","step","min","max","valueLabelDisplay","justify","Math","floor","n_null","filter","i","includes","renderQuestion","q","RadioGroup","name","concat","map","c","j","FormControlLabel","control","Radio","labelPlacement","renderChoice","reduce","q1","q2","Divider","random","toString","Submission","submission","studyId","submissionNote","submissionApi","submissionCode","isProlific","_resp$view","view","pid","resps","responses","findProlificId","ReactGA","event","category","action","fetch","method","body","JSON","stringify","headers","then","json","respJson","catch","error","BART","reward","maxPumps","safePumps","trials","pumps","trial","totalScore","trialResponses","dialogIsOpen","taskStartedAt","Date","now","showTooltip","shuffle","a","_ref2","randomNumbers","_","document","style","documentElement","taskFinishedAt","taskDuration","newTrial","cashed","randomNumber","_toConsumableArray","score","result","balloonSize","rad","sqrt","PI","ceil","Dialog","onClose","disableBackdropClick","disableEscapeKeyDown","DialogTitle","DialogContent","DialogContentText","r","b","DialogActions","autoFocus","size","Typography","alignContent","cursor","width","height","transition","isSafe","randomIndex","splice","clock","sample","items","shuffled","slice","rnd","GoNoGo","onProgress","stimuliDuration","fixationDuration","timeoutsBeforeReset","feedbackDuration","correct","stimuli","trialStartedAt","respondedAt","timeouts","handleKeyPress","key","keyCode","choice","empty","startsWith","go","nogo","handleResponse","startTask","addEventListener","removeEventListener","stim","total","keys","leftGo","left","clearTimeout","setTimeout","trialType","_correct","endsWith","renderStimulus","stimulus","Star","fontSize","Circle","orientation","flexItem","Correct","Incorrect","Add","Stroop","rule","colors","words","randomizeTrials","randomizeChoices","stimulusDuration","randomize","_trials","_t","Object","assign","rt","_choice$split","split","_choice$split2","choiceWord","_stimulus$split","_stimulus$split2","_stimulus$split3","_stimulus$split4","word","_choice$split3","_choice$split4","CorrectIcon","IncorrectIcon","ItemTypes","OPPONENT","POT","PLAYER","useStyles","makeStyles","theme","root","flexGrow","paper","padding","medium","large","grey","getContrastText","backgroundColor","tealDark","teal","blueG","blueGrey","height100","language","personsLangPrefix","RepositoryBox","memo","amount","onDrop","accept","person","personsPrefix","lang","useParams","classes","_useDrop","useDrop","drop","collect","monitor","isOver","canDrop","_useDrop2","_useDrop2$","tokensList","push","MonetizedToken","boxName","Paper","ref","elevation","OpponentInfoBar","Avatar","getPersonKey","_Fragment","avatar","alt","field1","src","component","field2","field3","_ref3","_useDrag","useDrag","isDragging","_useDrag2","drag","preview","DragPreviewImage","connect","opacity","MonetizationOnIcon","Ultimatum","onNotification","tokens","useOpponentTypes","opponentTypes","dialogOptionalText","persons","_useState3","accepts","_useState4","boxes","setBoxes","_useState5","_useState6","shuffledPersons","setShuffledPersons","canFinishTrial","forEach","box","handleDrop","useCallback","fromBox","destBox","_shuffledPersons$pers","playerShare","find","accepted","personIndex","minAcceptable","opponentShare","opponent","filterredPersons","tags","checkResult","inclue","checkPersonHasTags","filterPersonsByTags","isTouchScreen","navigator","maxTouchPoints","msMaxTouchPoints","dndBackend","TouchBackend","HTML5Backend","disableTypography","decision","DndProvider","enableMouseEvents","Dictator","TaskSwitch","bottom","getCorrect","selectable","arguments","renderStimuliRow","pos","renderStimuli","SimplifiedTaskSwitch","stimuliProperties","figure","typeA","figureA","colorA","getCrorrectFromStimuli","draw","NBack","nback","iconFigures","star","circle","triangle","Triangle","rectangle","Rectangle","hand","Hand","ball","Ball","watch","Watch","school","School","cup","Cup","figureIndex","figureTotal","_state$stimuli","_state$stimuli2","selected","_state$stimuli3","_state$stimuli4","Box","Block","FigureCompoentnt","textAlign","GoNoGoAlt","names","_state$stimuli$trialT","_state$stimuli2$trial","Study","initialize","_useTranslation","_useParams","responseIsValid","subject","session","progress","loading","currentViewIndex","experiment","notification","setNotification","storeData","data","autoNext","prev","updateViewProgress","currentViewProgressPct","currentViewProgress","views","_state$view$requiredQ","required","nextViewIndex","changeLanguage","startedAt","send","hitType","page","location","pathname","startExperiment","ThemeProvider","dir","CssBaseline","LinearProgress","Container","maxWidth","Snackbar","autoHideDuration","Alert","severity","PROLIFIC_PID","STUDY_ID","SESSION_ID","renderView","About","LanguageSelector","entries","val","Link","to","AppRouter","Router","basename","Switch","Route","exact","path","ReactDOM","render","Suspense","fallback","I18nextProvider","getElementById"],"mappings":"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","file":"static/js/main.32980e45.chunk.js","sourcesContent":["import i18n from \"i18next\";\nimport { initReactI18next } from \"react-i18next\";\nimport Backend from \"i18next-xhr-backend\";\n\nexport const languages = {\n  'en': {title: 'English', direction: 'ltr'},\n  'fa': {title: '', direction: 'rtl'},\n  'ar': {title: '', direction: 'rtl'}\n}\n\n\ni18n\n  .use(Backend)\n  .use(initReactI18next)\n  .init({\n/*    \n    resources: {\n      en: { translation: en_locale },\n      fa: { translation: fa_locale },\n    },\n*/\n    lng: \"en\",\n    fallbackLng: 'en',\n    debug: process.env.NODE_ENV !== 'production',\n    keySeparator: false,\n    backend: {\n      loadPath: process.env.PUBLIC_URL + '/locales/{{lng}}.json',\n    },\n  });\n\nexport default i18n;","import {createMuiTheme, responsiveFontSizes} from '@material-ui/core';\n\nconst darkTheme = createMuiTheme({\n  palette: {\n    type: 'dark',\n    primary: {\n      main: '#039be5'\n    },\n    secondary: {\n      main: '#f06292'\n    }\n  },\n  typography: {\n    fontFamily: [\n      'Vazir',\n      '-apple-system',\n      'BlinkMacSystemFont',\n      '\"Segoe UI\"',\n      'Roboto',\n      '\"Helvetica Neue\"',\n      'Arial',\n      'sans-serif',\n      '\"Apple Color Emoji\"',\n      '\"Segoe UI Emoji\"',\n      '\"Segoe UI Symbol\"',\n    ].join(',')\n  }\n});\n\nconst rtlDarkTheme = createMuiTheme({\n  direction: 'rtl',\n  palette: {\n    type: 'dark',\n    primary: {\n      main: '#039be5'\n    },\n    secondary: {\n      main: '#f06292'\n    }\n  },\n  typography: {\n    fontFamily: [\n      'Vazir',\n      '-apple-system',\n      'BlinkMacSystemFont',\n      '\"Segoe UI\"',\n      'Roboto',\n      '\"Helvetica Neue\"',\n      'Arial',\n      'sans-serif',\n      '\"Apple Color Emoji\"',\n      '\"Segoe UI Emoji\"',\n      '\"Segoe UI Symbol\"',\n    ].join(',')\n  }\n})\n\nexport const ltrTheme = responsiveFontSizes(darkTheme);\nexport const rtlTheme = responsiveFontSizes(rtlDarkTheme);\n","import React from 'react';\n\nimport {Button, Grid} from '@material-ui/core';\n\nimport {useTranslation} from 'react-i18next';\n\nexport default function Navigation({finished, redirectTo, onNext}) {\n\n  const {t} = useTranslation();\n\n  return (\n    <Grid container direction='row' justifyContent='flex-end'>\n      <Grid item>\n        {!finished && \n          <Button variant=\"contained\" color=\"primary\" onClick={onNext}>{t('next')}</Button>\n        }\n        {finished && redirectTo &&\n          <Button variant=\"contained\" color=\"primary\" href={redirectTo}>{t('finish_and_redirect')}</Button>        \n        }\n      </Grid>\n\n    </Grid>\n  );\n}","// From https://bitbucket.org/atlassian/atlaskit-mk-2/raw/4ad0e56649c3e6c973e226b7efaeb28cb240ccb0/packages/core/select/src/data/countries.js\nconst countries = [\n  { code: 'AD', label: 'Andorra', phone: '376' },\n  { code: 'AE', label: 'United Arab Emirates', phone: '971' },\n  { code: 'AF', label: 'Afghanistan', phone: '93' },\n  { code: 'AG', label: 'Antigua and Barbuda', phone: '1-268' },\n  { code: 'AI', label: 'Anguilla', phone: '1-264' },\n  { code: 'AL', label: 'Albania', phone: '355' },\n  { code: 'AM', label: 'Armenia', phone: '374' },\n  { code: 'AO', label: 'Angola', phone: '244' },\n  { code: 'AQ', label: 'Antarctica', phone: '672' },\n  { code: 'AR', label: 'Argentina', phone: '54' },\n  { code: 'AS', label: 'American Samoa', phone: '1-684' },\n  { code: 'AT', label: 'Austria', phone: '43' },\n  { code: 'AU', label: 'Australia', phone: '61', suggested: true },\n  { code: 'AW', label: 'Aruba', phone: '297' },\n  { code: 'AX', label: 'Alland Islands', phone: '358' },\n  { code: 'AZ', label: 'Azerbaijan', phone: '994' },\n  { code: 'BA', label: 'Bosnia and Herzegovina', phone: '387' },\n  { code: 'BB', label: 'Barbados', phone: '1-246' },\n  { code: 'BD', label: 'Bangladesh', phone: '880' },\n  { code: 'BE', label: 'Belgium', phone: '32' },\n  { code: 'BF', label: 'Burkina Faso', phone: '226' },\n  { code: 'BG', label: 'Bulgaria', phone: '359' },\n  { code: 'BH', label: 'Bahrain', phone: '973' },\n  { code: 'BI', label: 'Burundi', phone: '257' },\n  { code: 'BJ', label: 'Benin', phone: '229' },\n  { code: 'BL', label: 'Saint Barthelemy', phone: '590' },\n  { code: 'BM', label: 'Bermuda', phone: '1-441' },\n  { code: 'BN', label: 'Brunei Darussalam', phone: '673' },\n  { code: 'BO', label: 'Bolivia', phone: '591' },\n  { code: 'BR', label: 'Brazil', phone: '55' },\n  { code: 'BS', label: 'Bahamas', phone: '1-242' },\n  { code: 'BT', label: 'Bhutan', phone: '975' },\n  { code: 'BV', label: 'Bouvet Island', phone: '47' },\n  { code: 'BW', label: 'Botswana', phone: '267' },\n  { code: 'BY', label: 'Belarus', phone: '375' },\n  { code: 'BZ', label: 'Belize', phone: '501' },\n  { code: 'CA', label: 'Canada', phone: '1', suggested: true },\n  { code: 'CC', label: 'Cocos (Keeling) Islands', phone: '61' },\n  { code: 'CD', label: 'Congo, Democratic Republic of the', phone: '243' },\n  { code: 'CF', label: 'Central African Republic', phone: '236' },\n  { code: 'CG', label: 'Congo, Republic of the', phone: '242' },\n  { code: 'CH', label: 'Switzerland', phone: '41' },\n  { code: 'CI', label: \"Cote d'Ivoire\", phone: '225' },\n  { code: 'CK', label: 'Cook Islands', phone: '682' },\n  { code: 'CL', label: 'Chile', phone: '56' },\n  { code: 'CM', label: 'Cameroon', phone: '237' },\n  { code: 'CN', label: 'China', phone: '86' },\n  { code: 'CO', label: 'Colombia', phone: '57' },\n  { code: 'CR', label: 'Costa Rica', phone: '506' },\n  { code: 'CU', label: 'Cuba', phone: '53' },\n  { code: 'CV', label: 'Cape Verde', phone: '238' },\n  { code: 'CW', label: 'Curacao', phone: '599' },\n  { code: 'CX', label: 'Christmas Island', phone: '61' },\n  { code: 'CY', label: 'Cyprus', phone: '357' },\n  { code: 'CZ', label: 'Czech Republic', phone: '420' },\n  { code: 'DE', label: 'Germany', phone: '49', suggested: true },\n  { code: 'DJ', label: 'Djibouti', phone: '253' },\n  { code: 'DK', label: 'Denmark', phone: '45' },\n  { code: 'DM', label: 'Dominica', phone: '1-767' },\n  { code: 'DO', label: 'Dominican Republic', phone: '1-809' },\n  { code: 'DZ', label: 'Algeria', phone: '213' },\n  { code: 'EC', label: 'Ecuador', phone: '593' },\n  { code: 'EE', label: 'Estonia', phone: '372' },\n  { code: 'EG', label: 'Egypt', phone: '20' },\n  { code: 'EH', label: 'Western Sahara', phone: '212' },\n  { code: 'ER', label: 'Eritrea', phone: '291' },\n  { code: 'ES', label: 'Spain', phone: '34' },\n  { code: 'ET', label: 'Ethiopia', phone: '251' },\n  { code: 'FI', label: 'Finland', phone: '358' },\n  { code: 'FJ', label: 'Fiji', phone: '679' },\n  { code: 'FK', label: 'Falkland Islands (Malvinas)', phone: '500' },\n  { code: 'FM', label: 'Micronesia, Federated States of', phone: '691' },\n  { code: 'FO', label: 'Faroe Islands', phone: '298' },\n  { code: 'FR', label: 'France', phone: '33', suggested: true },\n  { code: 'GA', label: 'Gabon', phone: '241' },\n  { code: 'GB', label: 'United Kingdom', phone: '44' },\n  { code: 'GD', label: 'Grenada', phone: '1-473' },\n  { code: 'GE', label: 'Georgia', phone: '995' },\n  { code: 'GF', label: 'French Guiana', phone: '594' },\n  { code: 'GG', label: 'Guernsey', phone: '44' },\n  { code: 'GH', label: 'Ghana', phone: '233' },\n  { code: 'GI', label: 'Gibraltar', phone: '350' },\n  { code: 'GL', label: 'Greenland', phone: '299' },\n  { code: 'GM', label: 'Gambia', phone: '220' },\n  { code: 'GN', label: 'Guinea', phone: '224' },\n  { code: 'GP', label: 'Guadeloupe', phone: '590' },\n  { code: 'GQ', label: 'Equatorial Guinea', phone: '240' },\n  { code: 'GR', label: 'Greece', phone: '30' },\n  { code: 'GS', label: 'South Georgia and the South Sandwich Islands', phone: '500' },\n  { code: 'GT', label: 'Guatemala', phone: '502' },\n  { code: 'GU', label: 'Guam', phone: '1-671' },\n  { code: 'GW', label: 'Guinea-Bissau', phone: '245' },\n  { code: 'GY', label: 'Guyana', phone: '592' },\n  { code: 'HK', label: 'Hong Kong', phone: '852' },\n  { code: 'HM', label: 'Heard Island and McDonald Islands', phone: '672' },\n  { code: 'HN', label: 'Honduras', phone: '504' },\n  { code: 'HR', label: 'Croatia', phone: '385' },\n  { code: 'HT', label: 'Haiti', phone: '509' },\n  { code: 'HU', label: 'Hungary', phone: '36' },\n  { code: 'ID', label: 'Indonesia', phone: '62' },\n  { code: 'IE', label: 'Ireland', phone: '353' },\n  { code: 'IL', label: 'Israel', phone: '972' },\n  { code: 'IM', label: 'Isle of Man', phone: '44' },\n  { code: 'IN', label: 'India', phone: '91' },\n  { code: 'IO', label: 'British Indian Ocean Territory', phone: '246' },\n  { code: 'IQ', label: 'Iraq', phone: '964' },\n  { code: 'IR', label: 'Iran, Islamic Republic of', phone: '98' },\n  { code: 'IS', label: 'Iceland', phone: '354' },\n  { code: 'IT', label: 'Italy', phone: '39' },\n  { code: 'JE', label: 'Jersey', phone: '44' },\n  { code: 'JM', label: 'Jamaica', phone: '1-876' },\n  { code: 'JO', label: 'Jordan', phone: '962' },\n  { code: 'JP', label: 'Japan', phone: '81', suggested: true },\n  { code: 'KE', label: 'Kenya', phone: '254' },\n  { code: 'KG', label: 'Kyrgyzstan', phone: '996' },\n  { code: 'KH', label: 'Cambodia', phone: '855' },\n  { code: 'KI', label: 'Kiribati', phone: '686' },\n  { code: 'KM', label: 'Comoros', phone: '269' },\n  { code: 'KN', label: 'Saint Kitts and Nevis', phone: '1-869' },\n  { code: 'KP', label: \"Korea, Democratic People's Republic of\", phone: '850' },\n  { code: 'KR', label: 'Korea, Republic of', phone: '82' },\n  { code: 'KW', label: 'Kuwait', phone: '965' },\n  { code: 'KY', label: 'Cayman Islands', phone: '1-345' },\n  { code: 'KZ', label: 'Kazakhstan', phone: '7' },\n  { code: 'LA', label: \"Lao People's Democratic Republic\", phone: '856' },\n  { code: 'LB', label: 'Lebanon', phone: '961' },\n  { code: 'LC', label: 'Saint Lucia', phone: '1-758' },\n  { code: 'LI', label: 'Liechtenstein', phone: '423' },\n  { code: 'LK', label: 'Sri Lanka', phone: '94' },\n  { code: 'LR', label: 'Liberia', phone: '231' },\n  { code: 'LS', label: 'Lesotho', phone: '266' },\n  { code: 'LT', label: 'Lithuania', phone: '370' },\n  { code: 'LU', label: 'Luxembourg', phone: '352' },\n  { code: 'LV', label: 'Latvia', phone: '371' },\n  { code: 'LY', label: 'Libya', phone: '218' },\n  { code: 'MA', label: 'Morocco', phone: '212' },\n  { code: 'MC', label: 'Monaco', phone: '377' },\n  { code: 'MD', label: 'Moldova, Republic of', phone: '373' },\n  { code: 'ME', label: 'Montenegro', phone: '382' },\n  { code: 'MF', label: 'Saint Martin (French part)', phone: '590' },\n  { code: 'MG', label: 'Madagascar', phone: '261' },\n  { code: 'MH', label: 'Marshall Islands', phone: '692' },\n  { code: 'MK', label: 'Macedonia, the Former Yugoslav Republic of', phone: '389' },\n  { code: 'ML', label: 'Mali', phone: '223' },\n  { code: 'MM', label: 'Myanmar', phone: '95' },\n  { code: 'MN', label: 'Mongolia', phone: '976' },\n  { code: 'MO', label: 'Macao', phone: '853' },\n  { code: 'MP', label: 'Northern Mariana Islands', phone: '1-670' },\n  { code: 'MQ', label: 'Martinique', phone: '596' },\n  { code: 'MR', label: 'Mauritania', phone: '222' },\n  { code: 'MS', label: 'Montserrat', phone: '1-664' },\n  { code: 'MT', label: 'Malta', phone: '356' },\n  { code: 'MU', label: 'Mauritius', phone: '230' },\n  { code: 'MV', label: 'Maldives', phone: '960' },\n  { code: 'MW', label: 'Malawi', phone: '265' },\n  { code: 'MX', label: 'Mexico', phone: '52' },\n  { code: 'MY', label: 'Malaysia', phone: '60' },\n  { code: 'MZ', label: 'Mozambique', phone: '258' },\n  { code: 'NA', label: 'Namibia', phone: '264' },\n  { code: 'NC', label: 'New Caledonia', phone: '687' },\n  { code: 'NE', label: 'Niger', phone: '227' },\n  { code: 'NF', label: 'Norfolk Island', phone: '672' },\n  { code: 'NG', label: 'Nigeria', phone: '234' },\n  { code: 'NI', label: 'Nicaragua', phone: '505' },\n  { code: 'NL', label: 'Netherlands', phone: '31' },\n  { code: 'NO', label: 'Norway', phone: '47' },\n  { code: 'NP', label: 'Nepal', phone: '977' },\n  { code: 'NR', label: 'Nauru', phone: '674' },\n  { code: 'NU', label: 'Niue', phone: '683' },\n  { code: 'NZ', label: 'New Zealand', phone: '64' },\n  { code: 'OM', label: 'Oman', phone: '968' },\n  { code: 'PA', label: 'Panama', phone: '507' },\n  { code: 'PE', label: 'Peru', phone: '51' },\n  { code: 'PF', label: 'French Polynesia', phone: '689' },\n  { code: 'PG', label: 'Papua New Guinea', phone: '675' },\n  { code: 'PH', label: 'Philippines', phone: '63' },\n  { code: 'PK', label: 'Pakistan', phone: '92' },\n  { code: 'PL', label: 'Poland', phone: '48' },\n  { code: 'PM', label: 'Saint Pierre and Miquelon', phone: '508' },\n  { code: 'PN', label: 'Pitcairn', phone: '870' },\n  { code: 'PR', label: 'Puerto Rico', phone: '1' },\n  { code: 'PS', label: 'Palestine, State of', phone: '970' },\n  { code: 'PT', label: 'Portugal', phone: '351' },\n  { code: 'PW', label: 'Palau', phone: '680' },\n  { code: 'PY', label: 'Paraguay', phone: '595' },\n  { code: 'QA', label: 'Qatar', phone: '974' },\n  { code: 'RE', label: 'Reunion', phone: '262' },\n  { code: 'RO', label: 'Romania', phone: '40' },\n  { code: 'RS', label: 'Serbia', phone: '381' },\n  { code: 'RU', label: 'Russian Federation', phone: '7' },\n  { code: 'RW', label: 'Rwanda', phone: '250' },\n  { code: 'SA', label: 'Saudi Arabia', phone: '966' },\n  { code: 'SB', label: 'Solomon Islands', phone: '677' },\n  { code: 'SC', label: 'Seychelles', phone: '248' },\n  { code: 'SD', label: 'Sudan', phone: '249' },\n  { code: 'SE', label: 'Sweden', phone: '46' },\n  { code: 'SG', label: 'Singapore', phone: '65' },\n  { code: 'SH', label: 'Saint Helena', phone: '290' },\n  { code: 'SI', label: 'Slovenia', phone: '386' },\n  { code: 'SJ', label: 'Svalbard and Jan Mayen', phone: '47' },\n  { code: 'SK', label: 'Slovakia', phone: '421' },\n  { code: 'SL', label: 'Sierra Leone', phone: '232' },\n  { code: 'SM', label: 'San Marino', phone: '378' },\n  { code: 'SN', label: 'Senegal', phone: '221' },\n  { code: 'SO', label: 'Somalia', phone: '252' },\n  { code: 'SR', label: 'Suriname', phone: '597' },\n  { code: 'SS', label: 'South Sudan', phone: '211' },\n  { code: 'ST', label: 'Sao Tome and Principe', phone: '239' },\n  { code: 'SV', label: 'El Salvador', phone: '503' },\n  { code: 'SX', label: 'Sint Maarten (Dutch part)', phone: '1-721' },\n  { code: 'SY', label: 'Syrian Arab Republic', phone: '963' },\n  { code: 'SZ', label: 'Swaziland', phone: '268' },\n  { code: 'TC', label: 'Turks and Caicos Islands', phone: '1-649' },\n  { code: 'TD', label: 'Chad', phone: '235' },\n  { code: 'TF', label: 'French Southern Territories', phone: '262' },\n  { code: 'TG', label: 'Togo', phone: '228' },\n  { code: 'TH', label: 'Thailand', phone: '66' },\n  { code: 'TJ', label: 'Tajikistan', phone: '992' },\n  { code: 'TK', label: 'Tokelau', phone: '690' },\n  { code: 'TL', label: 'Timor-Leste', phone: '670' },\n  { code: 'TM', label: 'Turkmenistan', phone: '993' },\n  { code: 'TN', label: 'Tunisia', phone: '216' },\n  { code: 'TO', label: 'Tonga', phone: '676' },\n  { code: 'TR', label: 'Turkey', phone: '90' },\n  { code: 'TT', label: 'Trinidad and Tobago', phone: '1-868' },\n  { code: 'TV', label: 'Tuvalu', phone: '688' },\n  { code: 'TW', label: 'Taiwan, Province of China', phone: '886' },\n  { code: 'TZ', label: 'United Republic of Tanzania', phone: '255' },\n  { code: 'UA', label: 'Ukraine', phone: '380' },\n  { code: 'UG', label: 'Uganda', phone: '256' },\n  { code: 'US', label: 'United States', phone: '1', suggested: true },\n  { code: 'UY', label: 'Uruguay', phone: '598' },\n  { code: 'UZ', label: 'Uzbekistan', phone: '998' },\n  { code: 'VA', label: 'Holy See (Vatican City State)', phone: '379' },\n  { code: 'VC', label: 'Saint Vincent and the Grenadines', phone: '1-784' },\n  { code: 'VE', label: 'Venezuela', phone: '58' },\n  { code: 'VG', label: 'British Virgin Islands', phone: '1-284' },\n  { code: 'VI', label: 'US Virgin Islands', phone: '1-340' },\n  { code: 'VN', label: 'Vietnam', phone: '84' },\n  { code: 'VU', label: 'Vanuatu', phone: '678' },\n  { code: 'WF', label: 'Wallis and Futuna', phone: '681' },\n  { code: 'WS', label: 'Samoa', phone: '685' },\n  { code: 'XK', label: 'Kosovo', phone: '383' },\n  { code: 'YE', label: 'Yemen', phone: '967' },\n  { code: 'YT', label: 'Mayotte', phone: '262' },\n  { code: 'ZA', label: 'South Africa', phone: '27' },\n  { code: 'ZM', label: 'Zambia', phone: '260' },\n  { code: 'ZW', label: 'Zimbabwe', phone: '263' },\n];\n\nexport default countries;","import React, { useRef, useEffect, useState, Fragment } from 'react';\nimport { TextField, Grid } from '@material-ui/core';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport { useTranslation } from 'react-i18next';\nimport Markdown from 'react-markdown/with-html';\n\nimport countries from './utils/countries';\n\n//css\nimport \"./text.css\";\n\nexport default function Text({content, onStore, onValidate}) {\n  //props: title, text, placeholder, help, required, pattern, instruction, autoComplete\n  //i18n: text.choose_a_country, text.no_options\n\n  const { t } = useTranslation();\n\n  const response = useRef(null);\n  const [state, setState] = useState({\n    value: null\n  });\n\n\n  useEffect(() => {\n    return () => {\n      onStore({\n        'view': content,\n        'response': response.current?.code || response.current\n      })\n    };\n  },[]);\n\n\n  const handleChange = (e, value) => {\n    response.current = value\n    setState({...state, value: value});\n\n    const resp = value?.code || response.current\n    console.log(resp)\n\n    onValidate(resp !== undefined && resp.length>0);\n  }\n\n\n  /**\n   * Componenet to select a country from a dropdown list.\n   * Enable this feature by adding `autoComplete:'coutries'` to the view.\n   */\n  const CountryAutoComplete = () => {\n\n    // ISO 3166-1 alpha-2 (No support for IE 11)\n    const countryToFlag = (isoCode) => {\n      return typeof String.fromCodePoint !== 'undefined'\n        ? isoCode\n            .toUpperCase()\n            .replace(/./g, (char) => String.fromCodePoint(char.charCodeAt(0) + 127397))\n        : isoCode;\n    }\n\n    return (\n      <Autocomplete\n        id=\"country-select\"\n        options={countries}\n        autoHighlight\n        onChange={(e, v) => handleChange(e, v)}\n        value={state.value}\n        getOptionLabel={(option) => option.label}\n        noOptionsText={t('text.no_options')}\n        renderOption={(option) => (\n          <Fragment>\n            <span>{countryToFlag(option.code)}</span> {option.label}\n          </Fragment>\n        )}\n        renderInput={(params) => (\n          <TextField\n            {...params}\n            label={t('text.choose_a_country')}\n            variant=\"outlined\"\n            inputProps={{\n              ...params.inputProps,\n              autoComplete: 'new-password', // disable autocomplete and autofill\n            }}\n            className='country-select'\n          />\n        )}\n      />\n    );\n  }\n\n\n  return (\n    <Grid container direction='column' spacing={2} alignItems='stretch' justifyContent='flex-start' className='Text-container'>\n      <Grid item>\n        <Markdown source={t(content.text)} escapeHtml={false} className='markdown-text' />\n      </Grid>\n\n      {!(content.instruction || false) &&\n        <Grid item>\n          {content.autoComplete === 'countries' && <CountryAutoComplete />}\n          {!content.autoComplete && <TextField label={t(content.placeholder)} variant=\"filled\" fullWidth onChange={(e) => handleChange(e, e.target.value)} />}\n        </Grid>\n      }\n    </Grid>\n  );\n}\n","import React, { useRef, useEffect, useState } from 'react';\nimport { TextField, Grid } from '@material-ui/core';\nimport { useTranslation } from 'react-i18next';\nimport Markdown from 'react-markdown/with-html';\nimport { useLocation } from 'react-router-dom';\n\n//css\nimport \"./text.css\";\n\nfunction useQuery() {\n  return new URLSearchParams(useLocation().search);\n}\n\nexport default function Prolific({content, onStore, onValidate}) {\n  //props: title, text, placeholder, help, required, pattern, instruction, autoComplete\n  //i18n: text.choose_a_country, text.no_options\n\n  const { t } = useTranslation();\n  let query = useQuery();\n  const response = useRef(null);\n  const [state, setState] = useState({\n    value: null\n  });\n\n\n  useEffect(() => {\n    return () => {\n      onStore({\n        'view': content,\n        'response': response.current?.code || response.current\n      })\n    };\n  },[response]);\n\n\n  const handleChange = (e, value) => {\n    response.current = value\n    setState({...state, value: value});\n\n    const resp = value?.code || response.current\n    console.log(resp)\n\n    onValidate(resp !== undefined && resp.length>0);\n  }\n\n  var fieldContent = null;\n  if(content?.getUrlContent === true){\n    if(content?.paramNameAsContent !== null && content.paramNameAsContent?.length>0){\n      console.log(content?.paramNameAsContent);\n      fieldContent = query.get(content.paramNameAsContent);\n      console.log(fieldContent);\n    }\n  }else if(content?.content !== null && content?.content?.length>0){\n    fieldContent = content.content;\n  }\n  // run for the first time or s.t like that\n  if(state.value==null){\n    if(fieldContent!==null && fieldContent.length>0){\n      setState({ value : fieldContent});\n      return;\n    }\n  }\n\n  return (\n    <Grid container direction='column' spacing={2} alignItems='stretch' justifyContent='flex-start' className='Text-container'>\n      <Grid item>\n        <Markdown source={t(content.text)} escapeHtml={false} className='markdown-text' />\n      </Grid>\n\n      {!(content.instruction || false) &&\n        <Grid item>\n          <TextField label={t(content.placeholder)} defaultValue={fieldContent!=null ? fieldContent : undefined} variant=\"filled\" fullWidth onChange={(e) => handleChange(e, e.target.value)} />\n        </Grid>\n      }\n    </Grid>\n  );\n}\n","import React, {useEffect, useRef} from 'react';\n\nimport {Grid, Radio, Tooltip, RadioGroup, FormControlLabel, Divider, Slider} from '@material-ui/core';\n\nimport Markdown from 'react-markdown/with-html';\nimport {useTranslation} from 'react-i18next';\n\nfunction ValueLabelComponent(props) {\n  const { children, open, value } = props;\n\n  return (\n    <Tooltip open={open} enterTouchDelay={0} placement=\"top\" title={value} arrow>\n      {children}\n    </Tooltip>\n  );\n}\n\nexport default function Matrix({content, onStore, onValidate}) {\n\n  const {t} = useTranslation();\n  const {questions, choices, direction, text, slider, showMidMark } = content;\n\n  const response = useRef({\n    values: Array.from({ length: questions.length })\n  });\n\n  useEffect(() => {\n    if (content.requiredQuestions.length>0)\n      onValidate(false);\n    \n    window.scrollTo({top: 0, behavior: \"smooth\"});\n    return () => {\n      onStore({\n        'view': content,\n        'response': response.current\n      })\n    };\n  },[]);\n\n  const renderSlider = (choices, index) => {\n    return (\n      <Grid item container xs key={index} className='matrix-slider'>\n        <Slider\n          defaultValue={response.current.values[index]}\n          value={response.current.values[index]}\n          valueLabelFormat={(v) => t(choices[v-1])}\n          aria-labelledby={\"question\"+index}\n          ValueLabelComponent={ValueLabelComponent}\n          onChangeCommitted={(e, value) => handleChange(e, index, value)}\n          step={1}\n          min={1}\n          max={choices.length}\n          valueLabelDisplay=\"on\"\n        />\n        <Grid container direction='row' alignItems='stretch' justify='space-between'>\n          <Grid item className='mark'><em>{t(choices[0])}</em></Grid>\n          {showMidMark && <Grid item className='mark'><em>{t(choices[Math.floor(choices.length/2)])}</em></Grid>}\n          <Grid item className='mark'><em>{t(choices[choices.length-1])}</em></Grid>\n        </Grid>\n\n      </Grid>\n    )\n  }\n\n  const renderChoice = (c, index) => {\n    return (\n      <Grid item xs key={index}>\n        <FormControlLabel\n          control={<Radio />}\n          value={c}\n          label={t(c)}\n          labelPlacement={direction==='vertical'?'end':'bottom'}\n        />\n      </Grid>\n    )\n  }\n\n  const handleChange = (e, index, value) => {\n    response.current.values[index] = e.target.value || value;\n\n    console.log(response.current.values[index]);\n    const n_null = response.current.values.filter((v,i) => {\n      //console.log(v,i)\n      return content.requiredQuestions.includes(i) && (v === null || v===undefined)\n    }).length\n    //console.log('n_null', n_null)\n    onValidate(n_null === 0)\n  }\n\n  const renderQuestion = (q, index) => {\n    return (\n      <Grid item key={index} className='matrix-question-container'>\n      <Markdown source={t(q)} escapeHtml={false} className='markdown-text' />\n      {slider && renderSlider(choices, index)}\n      {!slider && \n        <RadioGroup name={`q${index}`} value={response.current.values[index]} onChange={(e) => handleChange(e, index)}>\n        <Grid container \n          direction={direction==='vertical'?'column':'row'} \n          alignItems='flex-start' \n          justify=\"space-between\">\n          {choices.map((c, j) => renderChoice(c, j))}\n        </Grid>\n        </RadioGroup>\n      }\n      </Grid>\n    ) \n  }\n\n  return (\n    <Grid container direction='column' alignItems='stretch' justifyContent='flex-start' className='Text-container'>\n      {text && \n      <Grid item>\n        <Markdown source={t(text)} escapeHtml={false} className='markdown-text' />\n      </Grid>\n      }\n      {questions\n        .map((q,i) => renderQuestion(q,i))\n        .reduce((q1, q2) => [q1,<Divider key={Math.random().toString()} className='matrix-spacer'/>,q2])}\n    </Grid>\n  );\n}\n","import React, { useEffect, useState } from 'react';\n\nimport {Grid} from '@material-ui/core';\nimport Markdown from 'react-markdown/with-html';\nimport {useTranslation} from 'react-i18next';\nimport ReactGA from \"react-ga4\";\n\nexport default function Submission({submission, studyId, submissionNote}) {\n\n  const {t} = useTranslation();\n  const submissionApi = `https://server.cut.social/api/v1/${studyId}/responses`;\n\n  const [state, setState] = useState({\n    submissionCode: undefined,\n    debug: process.env.NODE_ENV !== 'production',\n  });\n\n  function isProlific(resp) {\n    if(resp && resp?.view?.id===\"prolific ID\")\n      return true;\n    return false;\n  }\n\n  const findProlificId = () => {\n    let pid = null;\n    const resps = submission.responses.filter(isProlific);\n    if(resps.length>0)\n      pid=resps[0].response;\n    return pid;\n  }\n\n  // submit and set submissionCode\n  useEffect(() => {\n    if (state.submissionCode === undefined) {\n      const pid = findProlificId();\n      //console.log(\"pid:\",pid);\n      ReactGA.event({\n        category: \"info\",\n        action: \"submission_insert, pid : \"+pid,\n        label: \"info submission insert\"\n      });\n      fetch(submissionApi, {\n        method: 'post',\n        //mode: 'no-cors',\n        body: JSON.stringify(submission),\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      })\n        .then(resp => resp.json())\n        .then(respJson => setState({...state, submissionCode: respJson.submissionCode}))\n        .catch(error => {\n          ReactGA.event({\n            category: \"error\",\n            action: \"submission_insert_error, pid : \"+pid +'  error:' + error + '  stringify:'+ JSON.stringify(error),\n            label: \"info submission insert: \" + JSON.stringify(submission)\n          });\n          return console.error('Error:', error);\n        });\n    }\n  },[state]);\n\n  return (\n    <Grid container direction='column' className='Text-container'>\n      \n      {state.submissionCode &&\n      <Grid item xs className=\"submission-container\">\n        <Markdown source={t(submissionNote, {submissionCode: state.submissionCode})} escapeHtml={false}  className='markdown-text' />\n      </Grid>\n      }\n\n      {state.debug && \n      <Grid item xs>\n        <pre>{JSON.stringify(submission, null, 2)}</pre>\n      </Grid>\n      }\n\n    </Grid>\n  );\n}\n","import React, {useState, useEffect, Fragment, useRef} from 'react';\n\nimport {Button, Fab, Grid, Typography, Divider, Tooltip} from '@material-ui/core';\n\nimport {Dialog, DialogActions, DialogTitle, DialogContentText, DialogContent} from '@material-ui/core';\n\nimport { useTranslation } from 'react-i18next';\n\nimport './bart.css';\n\nexport default function BART({content, onStore}) {\n  \n  const { t } = useTranslation();\n  const {reward, maxPumps, safePumps, trials} = content;\n\n  const [state, setState] = useState({\n    pumps: 0,\n    finished: false,\n    trial: 1,\n    totalScore: 0,\n    trialResponses: [],\n    dialogIsOpen: false,\n    taskStartedAt: Date.now(),\n    showTooltip: true\n  });\n\n  const shuffle = (a) => {\n    for (let i = a.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [a[i], a[j]] = [a[j], a[i]];\n    }\n    return a;\n  }\n\n  // on mount and unmount\n  useEffect(() => {\n\n    // create a list of random numbers and shuffle it\n    state.randomNumbers = shuffle(Array.from({length: maxPumps}, (_, i) => i+1));\n\n    document.body.style['touch-action'] = \"none\";\n    document.documentElement.style['touch-action'] = \"none\";\n    return () => {\n      document.body.style['touch-action'] = null;\n      document.documentElement.style['touch-action'] = null;  \n    }\n  },[]);\n  \n  // when finished, store responses and proceed to the next view\n  useEffect(() => {\n    if (state.finished && !state.dialogIsOpen) {\n      const now = Date.now()\n      // add timestamps\n      let response = {trials: state.trialResponses};\n      response.taskStartedAt = state.taskStartedAt;\n      response.taskFinishedAt = now;\n      response.taskDuration = now - state.taskStartedAt;\n      onStore({\n        'view': content,\n        'response': response\n      }, true); // store + next\n    }\n  }, [state]);\n\n  /**\n   * Store trial responses, then proceed to the next trial or finish the game\n   * @param {*} cashed either cashed or exploded\n   * @param {*} explosionProbability last probability of balloon getting exploded\n   */\n  const newTrial = (cashed, randomNumber) => {\n    setState({\n      ...state, \n      dialogIsOpen: true,\n      trialResponses: [...state.trialResponses, {\n        trial: state.trial,\n        pumps: state.pumps,\n        score: cashed? state.pumps * reward : 0,\n        result: cashed? \"cashed\" : \"exploded\"\n      }],\n      showTooltip: true,\n      finished: (state.trial>=trials),\n      pumps: 0,\n      trial: state.trial+1,\n      totalScore: state.totalScore + (cashed?state.pumps*reward:0),\n      randomNumbers: shuffle(Array.from({length: maxPumps}, (_, i) => i+1))\n    });\n  }\n\n  /**\n   * action to inflate the baloon\n   */\n  const onInflate = () => {\n\n    const isSafe = safePumps>0 && state.pumps<safePumps\n    let randomIndex = Math.floor(Math.random() * state.randomNumbers.length);\n    let randomNumber = state.randomNumbers.splice(randomIndex, isSafe?0:1);  \n    console.log('random number: ', randomNumber[0], '(must be 1 to explode)')\n\n    // if the randomly picked number is 1, then explode\n    if (randomNumber[0] === 1) {\n      newTrial(false, randomNumber);\n    } else {\n        setState({\n        ...state,\n        showTooltip: false,\n        pumps: state.pumps+1\n      });\n    }\n\n  };\n\n  /**\n   * action to cash in the reward\n   */\n  const onCashIn = () => {\n    newTrial(true);\n  };\n  \n  /**\n   * render a dialog that shows trial summary.\n   */\n  const renderDialog = () => {\n    return (\n    <Dialog\n      open={state.dialogIsOpen}\n      onClose={() => setState({...state, dialogIsOpen: false})}\n      disableBackdropClick\n      disableEscapeKeyDown\n      aria-labelledby=\"dialog-title\"\n    >\n        <DialogTitle id=\"dialog-title\"><b>{state.trialResponses[state.trialResponses.length - 1].result==='cashed'?t('bart.cashed_title'):t('bart.exploded_title')}</b></DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n          {t('bart.trial_score_report', {score: state.trialResponses[state.trialResponses.length - 1].score})}\n          {t('bart.total_score_report', {score: state.trialResponses.map(r => r.score).reduce((a,b) => a+b, 0)})}\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setState({...state, dialogIsOpen: false})} color=\"primary\" autoFocus size='large'>\n            {state.trial<=trials?t('bart.next_trial'):t('next')}\n          </Button>\n        </DialogActions>\n      </Dialog>);\n  }\n\n  const balloonSize = (pumps, maxPumps) => {\n    //TODO let volume = 20/(1+Math.pow(Math.E, -3*(pumps/maxPumps))) // logit(3*pumps/maxPumps)\n    //TODO calc radius\n    let rad = Math.sqrt((pumps+1)*500/Math.PI)\n    console.log(rad)\n    return Math.ceil(2*rad)\n  }\n\n  /**\n   * Render BART component (main render)\n   */\n  //const render = () => {\n    return (\n      <Fragment>\n        {state.dialogIsOpen && renderDialog()}\n  \n        <Grid container direction='column' spacing={2} justify=\"space-between\" alignItems='stretch' className='bart-container'>\n  \n        <Grid item container direction='row' justify=\"space-around\" alignItems='center'>\n  \n          {state.trial<=trials && \n            <Grid item><Grid container direction='column' justify=\"space-around\" alignItems='center'>\n              {t('bart.next_reward')}<Typography variant=\"h4\">{state.pumps * reward}</Typography>\n            </Grid></Grid>\n          }\n  \n          {state.trial<=trials && \n            <Grid item><Grid container direction='column' justify=\"space-around\" alignItems='center'>\n                <Typography color='textSecondary' variant='caption'>{t('bart.trial_label',{trial:state.trial, trials:trials})}</Typography>\n            </Grid></Grid>\n          }\n  \n            <Grid item><Grid container direction='column' justify=\"space-around\" alignItems='center'>\n              {t('bart.total_points')}<Typography variant=\"h4\">{state.totalScore}</Typography>\n            </Grid></Grid>\n        </Grid>\n  \n        {/*<Grid item><Divider /></Grid>*/}\n        \n        <Grid item container direction=\"column\" alignContent='center' alignItems='center'> \n          <Tooltip title={t('bart.balloon_tooltip')} arrow open={!state.dialogIsOpen && state.showTooltip}>\n          <div className=\"bubble-container\" style={{\n            cursor: 'pointer',\n            width: balloonSize(state.pumps, maxPumps),\n            height: balloonSize(state.pumps, maxPumps),\n            transition: (state.pumps===0)?'':'width 1s, height 1s' //explosition and pumping effects\n          }}\n          onClick={onInflate}\n          >\n            <figure className=\"bubble\"></figure>\n          </div>\n          </Tooltip>\n        </Grid>\n  \n        <Grid item container direction=\"row\" justify=\"space-around\" alignItems='center'>\n          <Button size='large' color='primary' variant='outlined' onClick={onCashIn}>{t('bart.cash')}</Button>\n        </Grid>\n\n  \n        </Grid>\n      </Fragment>\n  \n    );\n  //} //.render()\n\n}\n","import React, { useState, useEffect, Fragment } from 'react';\n\n\nimport { Button, Grid, Divider } from '@material-ui/core';\n\nimport { \n  Star, \n  RadioButtonUnchecked as Circle, \n  Add,\n  Check as Correct,\n  Clear as Incorrect\n} from '@material-ui/icons';\n\nimport Markdown from 'react-markdown/with-html';\n\nimport { shuffle } from './utils/random';\nimport { useTranslation } from 'react-i18next';\n\nimport './gonogo.css';\n\n//FIXME these are realtime variables, so I keep them out of the component's state.\nlet clock\n\nexport default function GoNoGo({content, onStore, onProgress}) {\n\n  const {t} = useTranslation();\n  const {text, trials, stimuliDuration, fixationDuration, choices, timeoutsBeforeReset, feedbackDuration} = content;\n\n  const [state, setState] = useState({\n    finished: false,\n    trialResponses: [],\n    taskStartedAt: null,\n    taskFinishedAt: null,\n    taskDuration: null,\n    step: null,\n    correct: null,\n    stimuli: null,\n    trialStartedAt: null,\n    respondedAt: null,\n    trial: null,\n    timeouts: 0\n  })\n\n  /**\n   * callback to handle keypress events\n   */\n  const handleKeyPress = (event) => {\n    const { key, keyCode } = event;\n\n    // press space to start the task\n    if (state.trial === null && (keyCode===32 || key===' ')) {\n      startTask()\n      return;\n    }\n\n    // ignore invalid keys and invalid trial steps\n    if (state.step !== 'stimuli' || !['ArrowLeft', 'ArrowRight'].includes(key))\n      return;\n\n    const current = state.stimuli[state.trial-1];\n    let choice = undefined;\n\n    let empty = (key==='ArrowLeft' && current.startsWith('right')) || \n                (key==='ArrowRight' && current.startsWith('left'))\n    let go = (key==='ArrowLeft' && current==='left-go') ||\n             (key==='ArrowRight' && current==='right-go') \n\n    choice = go?choices.go:(empty?'empty':choices.nogo)\n\n    handleResponse(choice)\n    \n  }\n\n  useEffect(() => {\n    window.addEventListener('keydown', handleKeyPress);\n\n    return () => {\n      window.removeEventListener('keydown', handleKeyPress);\n    };\n  }, [handleKeyPress]);\n\n\n  useEffect(() => {\n\n    // generate stimuli stream\n    if (state.stimuli===null) {\n      let stim = [...Array(trials.total).keys()].map((i,t) => {\n        if (i<trials.leftGo)\n          return 'left-go'\n        if (i<trials.go)\n          return 'right-go'\n        if (i<trials.go + (trials.left - trials.leftGo))\n          return 'left-nogo'\n        return 'right-nogo'\n      }) \n      setState({...state, stimuli: shuffle(stim)});\n    }\n\n\n    // # FIXATION\n    if (state.step === 'fixation') {\n      clearTimeout(clock);  \n      clock = setTimeout(() => {\n          setState({\n            ...state, \n            trial: state.trial+1, \n            trialStartedAt: Date.now(), \n            step: 'stimuli'\n          });\n        }, fixationDuration);\n    }\n\n    // # FEEDBACK\n    if (state.step === 'feedback') {\n      clearTimeout(clock);\n      clock = setTimeout(() => {\n          setState({...state, step: 'fixation'})\n        }, feedbackDuration)\n    }\n\n    if (state.step === 'stimuli') {\n      clearTimeout(clock);\n\n      if (state.timeouts<timeoutsBeforeReset) {\n        clock = setTimeout(() => {\n          setState({...state,\n            trialResponses: [...state.trialResponses, {\n              'trial': state.trial,\n              'stimuli': state.stimuli[state.trial-1],\n              'choice': null,\n              'correct': null,\n              'respondedAt': null,\n              'trialStartedAt': state.trialStartedAt,\n              'rt': null\n            }],\n            timeouts: state.timeouts + 1,\n            correct: false,\n            step: (feedbackDuration>0)?'feedback':'fixation'\n          });\n        }, stimuliDuration)\n      } else {\n        setState({...state, step: 'reset', timeouts: 0})\n      }\n    }\n\n\n    onProgress(100.0 * state.trial / trials.total)\n  \n    if (state.trial>trials.total) {\n      console.log('------------ FINISHED -------')\n      onProgress(100.0)\n      setState({...state, finished: true, taskFinishedAt: Date.now()})\n    }\n\n    // on finish\n    if (state.finished) {\n      clearTimeout(clock);\n      \n      // timestamps\n      let response = {trials: state.trialResponses};\n      response.taskStartedAt = state.taskStartedAt;\n      response.taskFinishedAt = state.taskFinishedAt;\n      response.taskDuration = state.taskFinishedAt - state.taskStartedAt;\n      onStore({\n        'view': content,\n        'response': response\n      }, true); // store + next\n    }\n\n  },[state]);\n\n  const startTask = () => {\n    setState({\n      ...state, \n      trialResponses: [], \n      trial: 0, \n      timeouts: 0, \n      step: 'fixation', \n      taskStartedAt: Date.now()\n    })\n  }\n\n  const handleResponse = (choice) => {\n    const respondedAt = Date.now(); //timestamp\n\n    clearTimeout(clock);\n\n    const _correct = (choice===choices.go && !state.stimuli[state.trial-1].endsWith('nogo')) || \n              (choice==='empty' && state.stimuli[state.trial-1].endsWith('nogo'))\n\n    setState({\n      ...state,\n      correct: _correct,\n      respondedAt: respondedAt,\n      trialResponses: [...state.trialResponses, {\n        'trial': state.trial,\n        'stimuli': state.stimuli[state.trial-1],\n        'choice': choice,\n        'correct': _correct,\n        'respondedAt': respondedAt,\n        'trialStartedAt': state.trialStartedAt,\n        'rt': respondedAt - state.trialStartedAt\n      }],\n      step: (feedbackDuration>0)?'feedback':'fixation'\n    })\n  }\n\n  const renderStimulus = (stimulus) => {\n    return (\n      <Fragment>\n      {stimulus==='star' && <div onClick={() => handleResponse('star')} className='gng-stimulus'><Star fontSize='large' className='yellow' /></div>}\n      {stimulus==='empty' && <div onClick={() => handleResponse('empty')} className='gng-stimulus'> </div>}\n      {stimulus==='circle' && <div onClick={() => handleResponse('circle')} className='gng-stimulus'><Circle fontSize='large' className='blue' /></div>}\n      {stimulus==='blue-star' && <div onClick={() => handleResponse('blue-star')} className='gng-stimulus'><Star fontSize='large' className='blue' /></div>}\n      {stimulus==='yellow-circle' && <div onClick={() => handleResponse('yellow-circle')} className='gng-stimulus'><Star fontSize='large' className='yellow' /></div>}\n      </Fragment>\n    );\n  }\n\n  const renderStimuli = (trialType) => {\n    return (\n      <Grid item container direction=\"row\" justifyContent=\"space-around\" alignItems=\"center\">\n        {trialType === 'left-go' && renderStimulus(choices.go)}\n        {trialType === 'left-nogo' && renderStimulus(choices.nogo)}\n        {(trialType !== 'left-go' && trialType !== 'left-nogo') && renderStimulus('empty')}\n        <Divider orientation=\"vertical\" flexItem />\n        {trialType === 'right-go' && renderStimulus(choices.go)}\n        {trialType === 'right-nogo' && renderStimulus(choices.nogo)}\n        {(trialType !== 'right-go' && trialType !== 'right-nogo') && renderStimulus('empty')}\n      </Grid>\n    )\n  }\n\n  const renderFeedback = () => {\n    return (\n      <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n        {state.correct && <Correct fontSize='large' className='correct gng-icon' />}\n        {!state.correct && <Incorrect fontSize='large' className='incorrect gng-icon' />}\n      </Grid>\n    )\n\n  }\n\n  const renderFixation = () => {\n    return (\n      <Grid item container direction=\"row\" justifyContent=\"space-around\" alignItems=\"center\">\n        <Add fontSize='large' className='fixation gng-icon' />\n      </Grid>\n    );\n  }\n\n  // show reset screen on timeouts reaching a threshold\n  if (state.step === 'reset') {\n    return (\n      <Grid container direction='column' spacing={2} alignItems='center' justifyContent='flex-start' className='Text-container'>\n        <Grid item><Markdown source={t('gonogo.too_many_timeouts')} escapeHtml={false}  className='markdown-text' /></Grid>\n        <Grid item>\n          <Button variant='outlined' color='secondary' onClick={() => startTask()}>{t('gonogo.restart')}</Button>\n        </Grid>\n      </Grid>\n\n    )\n  }\n\n  // start screen\n  if (state.trial === null) {\n    return (\n      <Grid container direction='column' spacing={2} alignItems='center' justifyContent='flex-start' className='Text-container'>\n        <Grid item><Markdown source={t('gonogo.are_you_ready')} escapeHtml={false} className='markdown-text' /></Grid>\n        <Grid item>\n          <Button variant='outlined' onClick={() => startTask()}>{t('gonogo.start')}</Button>\n        </Grid>\n\n      </Grid>\n\n    )\n  }\n\n  //const render = () => {\n    return (\n        <Grid item container direction='column' spacing={2} alignItems='stretch' justifyContent='flex-start' className='gonogo-container'>\n          <Grid item>\n            <Markdown source={t(text)} escapeHtml={false} className='markdown-text' />\n          </Grid>\n\n          {state.step === 'stimuli'  && renderStimuli(state.stimuli[state.trial-1])}\n          {state.step === 'feedback' && renderFeedback()}\n          {state.step === 'fixation' && renderFixation()}\n\n        </Grid>\n\n    );\n  //} //.render()\n\n}\n","export const sample = (items, n=1) => {\n  let rnd = Math.floor(Math.random()*items.length);\n  return items[rnd];\n}\n\n  /**\n  * Shuffles any array and returns it\n  * @param {*any} items any array to be shuffled\n  * @returns shuffled array\n  */\nexport const shuffle = (items) => {\n  const shuffled = items.slice();\n  for (let i = items.length - 1; i > 0; i--) {\n      const rnd = Math.floor(Math.random() * (i + 1));\n      [shuffled[i], shuffled[rnd]] = [shuffled[rnd], shuffled[i]];\n  }\n  return shuffled;\n};","  /**\n  * Shuffles any array and returns it\n  * @param {*any} a any array\n  * @returns shuffled array\n  */\nconst shuffle = (a) => {\n  for (let i = a.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [a[i], a[j]] = [a[j], a[i]];\n  }\n  return a;\n}\n\nexport default shuffle;","import React, {useState, useEffect, useRef} from 'react';\n\n\nimport { Box, Button, Grid, Typography, Divider} from '@material-ui/core';\n\nimport { \n  Add,\n  Check as CorrectIcon,\n  Clear as IncorrectIcon,\n} from '@material-ui/icons';\n\nimport shuffle from './utils/shuffle';\n\nimport Image from 'material-ui-image';\n\nimport Markdown from 'react-markdown/with-html';\n\nimport {useTranslation} from 'react-i18next';\n\nimport './stroop.css';\n\n//FIXME keep this var as a ref\nlet clock\n\nexport default function Stroop({content, onStore}) {\n\n  const {rule, colors, words, trials, randomizeTrials, randomizeChoices, stimulusDuration, fixationDuration, timeoutsBeforeReset, feedbackDuration} = content;\n\n\n  const {t} = useTranslation();\n  const separator = ''; // character that separates word and color in trials[i].stimulus and trials[i].choices\n\n  const [state, setState] = useState({\n    trialResponses: [],\n    finished: false,\n    trial: null,\n    step: null,\n    correct: null,\n    timeouts: 0,\n    stimuli: null\n  });\n\n    /**\n   * callback to handle keypress events\n   */\n  const handleKeyPress = (event) => {\n    const { key, keyCode } = event;\n\n    // press space to start the task\n    if (state.trial === null && (keyCode===32 || key===' ')) {\n      startTask()\n      return;\n    }\n\n    // ignore invalid key press at invalid stage of the trial\n    if (state.step !== 'stimulus' || !['ArrowLeft', 'ArrowRight'].includes(key))\n      return;\n\n    let choices = state.stimuli[state.trial-1].choices\n    let stimulus = state.stimuli[state.trial-1].stimulus\n\n    let choice = (key==='ArrowLeft')?choices[0]:choices[1]\n\n    handleResponse(choice, stimulus)\n    \n  }\n\n  useEffect(() => {\n    window.addEventListener('keydown', handleKeyPress);\n\n    return () => {\n      window.removeEventListener('keydown', handleKeyPress);\n    };\n  }, [handleKeyPress]);\n\n\n  const randomize = (trials/*use props instead of: , randomizeTrials, randomizeChoices*/) => {\n    let _trials = (randomizeTrials || false)?shuffle(trials):trials\n    if (randomizeChoices)\n      _trials = _trials.map(t=> {\n        let _t = Object.assign({},t); // copy\n        _t.choices = shuffle(t.choices);\n        return _t;\n      })\n    return _trials\n  }\n\n  // when finished, store responses and proceed to the next view\n  useEffect(() => {\n\n    if (state.stimuli===null) {\n      setState({\n        ...state,\n        stimuli: randomize(trials, randomizeTrials, randomizeChoices)\n      })\n    }\n\n    if (state.step==='fixation') {\n      clearTimeout(clock);  \n      clock = setTimeout(() => {\n        setState({\n          ...state,\n          step: 'stimulus',\n          trial: state.trial+1, \n          trialStartedAt: Date.now()\n        });\n      }, fixationDuration);\n    }\n\n    if (state.step === 'feedback') {\n      clearTimeout(clock);\n      clock = setTimeout(() => {\n        setState({...state, step: 'fixation'})\n      }, feedbackDuration)\n    }\n\n    if (state.step === 'stimulus') {\n      clearTimeout(clock);\n\n      if (state.timeouts<timeoutsBeforeReset) {\n        clock = setTimeout(() => {\n          setState({\n            ...state,\n            step: (feedbackDuration>0)?'feedback':'fixation',\n            trialResponses: [...state.trialResponses, {\n              trial: state.trial,\n              stimulus: state.stimuli[state.trial-1].stimulus,\n              choice: null,\n              correct: null,\n              respondedAt: null,\n              trialStartedAt: state.trialStartedAt,\n              rt: null}\n            ],\n            timeouts: state.timeouts + 1,\n            correct: false\n          });\n        }, stimulusDuration);\n      } else {\n        setState({...state, step: 'reset', timeouts: 0})\n      }\n    }\n\n    if (state.trial>trials.length) {\n      setState({...state, finished: true, taskFinishedAt: Date.now()})\n    }\n\n    if (state.finished) {\n      clearTimeout(clock);\n\n      // timestamps\n      let response = {trials: state.trialResponses};\n      response.taskStartedAt = state.taskStartedAt;\n      response.taskFinishedAt = state.taskFinishedAt;\n      response.taskDuration = state.taskFinishedAt - state.taskStartedAt;\n      onStore({\n        'view': content,\n        'response': response\n      }, true); // store + next\n    }\n\n  }, [state]);\n\n  const startTask = () => {\n    setState({\n      ...state,\n      trial: 0,\n      timeouts: 0,\n      trialResponses: [],\n      step:'fixation', \n      taskStartedAt: Date.now() //timestamp\n    });\n  }\n\n  const handleResponse = (choice, stimulus) => {\n    let respondedAt = Date.now(); //timestamp\n\n    clearTimeout(clock);\n\n    let [choiceWord, choiceColor] = choice.split('')\n    let [stimulusWord, stimulusColor] = stimulus.split('')\n    let correct = (choiceWord === stimulusColor)\n\n    //DEBUG console.log(choiceColor, stimulusWord, correct)\n\n    setState({\n      ...state,\n      step: (feedbackDuration>0)?'feedback':'fixation',\n      correct: correct,\n      trialResponses: [...state.trialResponses,{\n        trial: state.trial,\n        stimulus: state.stimuli[state.trial-1].stimulus,\n        choice: choice,\n        correct: correct,\n        respondedAt: respondedAt,\n        trialStartedAt: state.trialStartedAt,\n        rt: respondedAt - state.trialStartedAt\n      }]\n    })\n  }\n\n  const renderStimulus = (stimulus) => {\n    let [word, color] = stimulus.split('')\n    return (\n      <Grid container item direction='column' alignItems='center' justify='flex-start'>\n      <Typography className='stroop-stimulus' variant='h1' style={{color: colors[color]}}>\n        {t(words[word])}\n      </Typography>\n      </Grid>\n\n    );\n  }\n\n  const renderChoices = (choices, stimulus) => {\n    \n    return (\n      <Grid container direction='row' justify='space-between' spacing={2} alignItems='stretch' className='stroop-choices'>\n      {choices.map((choice,i) => {\n        let [word, color] = choice.split('')\n        return (\n          <Grid item xs key={i}>\n          <Button style={{color: colors[color]}} onClick={() => handleResponse(choice, stimulus)} size=\"large\" fullWidth variant='outlined'>\n            {t(words[word])}\n          </Button>\n          </Grid>\n        );\n      })}\n      </Grid>\n    )\n  }\n\n  const renderFeedback = () => {\n    return (\n      <Grid item container direction='row' justify='space-around' alignItems='center'>\n        {state.correct && <CorrectIcon fontSize='large' className='correct gng-icon' />}\n        {!state.correct && <IncorrectIcon fontSize='large' className='incorrect gng-icon' />}\n      </Grid>\n    )\n\n  }\n\n  const renderStartScreen = () => {\n    return (\n      <Grid container direction='column' spacing={2} alignItems='center'>\n        <Grid item><Markdown source={t('stroop.are_you_ready')} escapeHtml={false} className='markdown-text' /></Grid>\n        <Grid item>\n          <Button variant='outlined' onClick={() => startTask()}>{t('stroop.start')}</Button>\n        </Grid>\n\n      </Grid>\n    )\n  }\n\n  const renderResetScreen = () => {\n    return (\n      <Grid container direction='column' spacing={2} alignItems='center' justify='flex-start' className='Text-container'>\n        <Grid item><Markdown source={t('stroop.too_many_timeouts')} escapeHtml={false} className='markdown-text' /></Grid>\n        <Grid item>\n          <Button variant='outlined' color='secondary' onClick={() => startTask()}>{t('stroop.restart')}</Button>\n        </Grid>\n      </Grid>\n    )\n  }\n\n  // show reset screen on timeouts reaching a threshold\n  if (state.step === 'reset') {\n    return renderResetScreen();\n  }\n\n  if (state.trial === null) {\n    return renderStartScreen();\n  }\n\n  \n  //const render = () => {\n    return (\n        <Grid item container direction='column' spacing={2} alignItems='stretch' justify='flex-start' className='stroop-container stroop-board'>\n          <Grid item>\n            <Markdown source={t(rule)} escapeHtml={false} className='markdown-text' />\n          </Grid>\n\n          {state.trial<=trials.length && \n            state.step === 'stimulus' && \n            renderStimulus(state.stimuli[state.trial-1].stimulus) }\n            \n          {state.trial<=trials.length && \n            state.step === 'stimulus' && \n            renderChoices(state.stimuli[state.trial-1].choices, state.stimuli[state.trial-1].stimulus) }\n\n          {state.step === 'feedback' && renderFeedback(state.correct)}\n\n          {state.step === 'fixation' && \n            <Grid item container direction=\"row\" justify=\"space-around\" alignItems=\"center\">\n              <Add fontSize='large' className='fixation gng-icon' />\n            </Grid>\n          }\n\n        </Grid>\n\n    );\n  //} //.render()\n\n}\n","import React, { Fragment, memo } from 'react';\nimport { useDrag, useDrop, DragPreviewImage } from 'react-dnd';\nimport { useTranslation } from 'react-i18next';\nimport { languages } from '../utils/i18n';\nimport MonetizationOnIcon from \"@material-ui/icons/MonetizationOn\";\nimport { ltrTheme, rtlTheme } from '../utils/theme';\nimport { grey, teal, blueGrey } from '@material-ui/core/colors';\nimport { Avatar, Grid, makeStyles, Paper, Typography } from '@material-ui/core';\nimport { useParams } from 'react-router-dom';\n\n// Item types of draggable components\nexport const ItemTypes = {\n  OPPONENT: 'opponent',\n  POT: 'pot',\n  PLAYER: 'player',\n}\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    flexGrow: 0,\n  },\n  paper: {\n    padding: theme.spacing(2),\n  },\n  medium: {\n    width: theme.spacing(3),\n    height: theme.spacing(3),\n  },\n  large: {\n    width: theme.spacing(4),\n    height: theme.spacing(4),\n  },\n  grey: {\n    color: theme.palette.getContrastText(grey[400]),\n    backgroundColor: grey[400],\n  },\n  tealDark: {\n    color: theme.palette.getContrastText(teal[800]),\n    backgroundColor: teal[800],\n  },\n  blueG: {\n    color: theme.palette.getContrastText(blueGrey[800]),\n    backgroundColor: blueGrey[800],\n  },\n  height100: {\n    height: '100%',\n  }\n}));\n\nvar language = undefined;\nvar personsLangPrefix = undefined;\n\n/***\n * Container box for monetized entities and their interactions\n */\nexport const RepositoryBox = memo(function RepositoryBox({\n  name,\n  amount,\n  onDrop,\n  accept,\n  person,\n  personsPrefix,\n}) {\n\n  let { lang } = useParams();\n  language = lang;\n  personsLangPrefix = personsPrefix;\n  console.log(personsLangPrefix);\n  const { t } = useTranslation();\n  const theme = (languages[language].direction === 'rtl') ? rtlTheme : ltrTheme;\n  const classes = useStyles(theme);\n  const style = {\n    height: '128px',\n  }\n\n  const [{ canDrop, isOver }, drop] = useDrop({\n    accept,\n    drop: onDrop,\n    collect: (monitor) => ({\n      isOver: monitor.isOver(),\n      canDrop: monitor.canDrop(),\n      //connectDropTarget: connect.dropTarget()\n    }),\n  })\n\n  const isActive = canDrop && isOver\n  let backgroundColor = '#222'\n  if (isActive) {\n    backgroundColor = 'darkgreen'\n  } else if (canDrop) {\n    backgroundColor = blueGrey[800]\n  }\n\n  const tokensList = [];\n  for (let i = 0; i < amount; i++) {\n    tokensList.push(<MonetizedToken type={name} name={name + i.toString()} key={name + i.toString()} boxName={name} />);\n  }\n\n  return (\n    <Grid item xs={12}>\n      <Paper ref={drop} className={classes.paper} style={{ ...style, backgroundColor }} elevation={3} >\n        <Grid container alignItems=\"center\" direction=\"row\" className={classes.height100}>\n          <Grid item xs={4}>\n            {name === ItemTypes.OPPONENT &&\n              <OpponentInfoBar person={person} />\n            }\n            {name !== ItemTypes.OPPONENT &&\n              <Typography>{t('dictator.' + name)}</Typography>\n            }\n          </Grid>\n          <Grid item xs={7}>\n            <Grid container direction=\"row\" justifyContent=\"flex-start\" alignItems=\"center\">\n              {tokensList}\n            </Grid>\n          </Grid>\n          <Grid item xs={1}>\n            <Grid container direction=\"column\" justifyContent=\"center\" alignItems=\"center\">\n              <Avatar className={`${classes.grey} ${classes.large}`}>{amount}</Avatar>\n            </Grid>\n          </Grid>\n        </Grid>\n      </Paper>\n    </Grid>\n  );\n})\n\n/**\n * uses the persons id and the field key alongside experiment loaded personLangPrefix to produce the locales key\n * @returns string for locales key\n */\nfunction getPersonKey(key, id) {\n  console.log(personsLangPrefix);\n  return personsLangPrefix + id + '.' + key;\n}\n\nconst OpponentInfoBar = memo(function OpponentInfoBar({ person }) {\n  const { t } = useTranslation();\n  const theme = (languages[language].direction === 'rtl') ? rtlTheme : ltrTheme;\n  const classes = useStyles(theme);\n  return (\n    <>\n      {person?.avatar &&\n        <Avatar alt={t(getPersonKey(person.field1, person.id))} src={process.env.PUBLIC_URL + \"/images/\" + person.avatar} className={classes.large} />\n      }\n      {!person?.avatar &&\n        <Avatar className={classes.large} />\n      }\n      <Typography variant=\"body1\" color=\"textPrimary\" component=\"p\">\n        {person?.field1 && t(getPersonKey(person.field1, person.id))}\n      </Typography>\n      <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">\n        {person?.field2 && t(getPersonKey(person.field2, person.id))}\n      </Typography>\n      <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">\n        {person?.field3 && t(getPersonKey(person.field3, person.id))}\n      </Typography>\n    </>\n  );\n})\n\n/***\n * Component which renders coin tokens and handles dragging events\n */\nconst MonetizedToken = memo(function MonetizedToken({ type, name, boxName }) {\n\n  const style = {\n    cursor: 'move',\n  }\n\n  const [{ isDragging }, drag, preview] = useDrag(\n    () => ({\n      type,\n      item: { name, boxName },\n      collect: (monitor) => ({\n        isDragging: !!monitor.isDragging(),\n      }),\n    }),\n    [name],\n  )\n  return (\n    <Grid item>\n      <DragPreviewImage connect={preview} src={process.env.PUBLIC_URL + \"/images/token-large.png\"} />\n      <span ref={drag} className='token-span' style={{ ...style, opacity: isDragging ? 0.5 : 1,}}> \n        <MonetizationOnIcon fontSize={isDragging? 'large':'medium'} /> \n      </span>\n    </Grid>\n\n  )\n})","import React, { useEffect, useState, Fragment, useCallback, } from 'react';\nimport { Typography, Button, Grid, Dialog, DialogTitle, \n          DialogContent, DialogContentText, DialogActions } from '@material-ui/core';\nimport { DndProvider } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport { TouchBackend } from 'react-dnd-touch-backend';\nimport { useTranslation } from 'react-i18next';\nimport { shuffle } from './utils/random';\nimport { ItemTypes, RepositoryBox } from './components/allotmentBox';\n\n//css\nimport \"./ultimatum.css\";\n\n\nexport default function Ultimatum({ content, onStore, onNotification }) {\n  //content:   text , tokens , trials , opponentTypes, useOpponentTypes, personsPrefix\n\n  const { t } = useTranslation();\n  const { tokens, trials, useOpponentTypes, opponentTypes, text, personsPrefix, dialogOptionalText, persons } = content;\n\n  //const theme = (languages[lang].direction === 'rtl') ? rtlTheme : ltrTheme;\n  //const classes = useStyles(theme);\n  \n  const [state, setState] = useState({\n    finished: false,\n    trial: null,\n    totalScore: 0,\n    dialogIsOpen: false,\n    trialResponses: [],\n    taskStartedAt: Date.now(),\n  });\n  const [boxes, setBoxes] = useState(\n    [\n      { name: ItemTypes.OPPONENT, amount: 0, accepts: [ItemTypes.POT, ItemTypes.PLAYER] },\n      { name: ItemTypes.POT, amount: tokens, accepts: [ItemTypes.PLAYER, ItemTypes.OPPONENT] },\n      { name: ItemTypes.PLAYER, amount: 0, accepts: [ItemTypes.POT, ItemTypes.OPPONENT] },\n    ]\n  )\n  const [shuffledPersons, setShuffledPersons] = useState(undefined);\n\n  // on mount and unmount\n  useEffect(() => {\n    // Nothing yet\n  }, []);\n\n  // when finished, store responses and proceed to the next view\n  useEffect(() => {\n    if (state.finished && !state.dialogIsOpen) {\n      const now = Date.now()\n      // add timestamps\n      let response = { trials: state.trialResponses };\n      response.taskStartedAt = state.taskStartedAt;\n      response.taskFinishedAt = now;\n      response.taskDuration = now - state.taskStartedAt;\n      onStore({\n        'view': content,\n        'response': response\n      }, true); // store + next\n    }\n  }, [state, onStore, content]);\n\n /**\n   * Filters persons to return only the persons that have any of the given tags \n   * @param {*persons} persons persons to be filtered by their tags\n   * @param {*} tags tags used to select the persons which their tags has at least one the tags given\n   * @returns \n   */\n  const filterPersonsByTags = (persons, tags) => {\n    if (useOpponentTypes !== true)\n      return persons;\n    const filterredPersons = persons.filter(person => { return checkPersonHasTags(person, tags) });\n      return filterredPersons;\n  }\n\n  /**\n   * Checks if the given person has any of the the given tags\n   * @returns true if the person has any of the given tags\n   */\n  function checkPersonHasTags(person, tags) {\n    var checkResult = false;\n    for (let i = 0; i < person.tags.length; i++) {\n      if (tags.inclue(person.tags[i]))\n        checkResult = true;\n    }\n    return checkResult;\n  }\n\n  const finishTrialAction = () => {\n    canFinishTrial() ? newTrial() : onNotification(t('ultimatum.errors.required'));\n  }\n\n  /***\n   * this function shows if this trial can be finished by the participant\n   */\n  const canFinishTrial = () => {\n    let result = false;\n    boxes.forEach((box) => {\n      if (box.name === ItemTypes.POT && box.amount === 0)\n        result = true;\n    });\n    return result;\n  }\n\n  /***\n   * Activated when player has droped a token (item that is dragged and name of the dropped box) by setting setBoxes\n   */\n  const handleDrop = useCallback(\n    (name, item) => {\n      // item is the entity that is dropped and has {name, boxName}\n      // name is the name of the repositoryBox that entity has been dropped into\n      const fromBox = item.boxName;\n      const destBox = name;\n      //console.log('dropped on: ',destBox);\n      //console.log('from : ',fromBox);\n      setBoxes(boxes.map(item => {\n        if (item.name === fromBox) {\n          return { ...item, amount: item.amount - 1 };\n        } else if (item.name === destBox) {\n          return { ...item, amount: item.amount + 1 };\n        } else {\n          return item;\n        }\n      }));\n    },\n    [boxes],\n  )\n\n  /***\n   * Starts the task for the first time\n   */\n  const startTask = () => {\n    let filterredPersons = filterPersonsByTags(persons, opponentTypes);\n    setShuffledPersons(shuffle(filterredPersons));\n    setState({\n      ...state,\n      trial: 0,\n      trialResponses: [],\n      taskStartedAt: Date.now() //timestamp\n    });\n  }\n\n  /**\n   * Store trial responses, then proceed to the next trial or finish the game\n   */\n  const newTrial = () => {\n    if (!canFinishTrial()) {\n      console.log('it should never come to this, because before calling newTrial, canFinishTrial has been checked!!!!');\n      onNotification(t('ultimatum.errors.required'));\n      return;\n    }\n    const playerShare = boxes.find(box => box.name === ItemTypes.PLAYER).amount;\n    let accepted = true;\n    if(shuffledPersons[personIndex]?.minAcceptable > (tokens-playerShare))\n      accepted = false;\n    setState({\n      ...state,\n      trialResponses: [...state.trialResponses, {\n        trial: state.trial,\n        playerShare: playerShare,\n        score: accepted ? playerShare : 0,\n        opponentShare: tokens - playerShare,\n        opponent: shuffledPersons[personIndex],\n        result: accepted ? \"accepted\" : \"rejected\"\n      }],\n      finished: (state.trial >= trials - 1),\n      trial: state.trial + 1,\n      totalScore: state.totalScore + (accepted ? playerShare : 0),\n      dialogIsOpen: true,\n    });\n\n    // when the trial finished the tokens in boxes should reset\n    setBoxes(\n      [\n        { name: ItemTypes.OPPONENT, amount: 0, accepts: [ItemTypes.POT, ItemTypes.PLAYER] },\n        { name: ItemTypes.POT, amount: tokens, accepts: [ItemTypes.PLAYER, ItemTypes.OPPONENT] },\n        { name: ItemTypes.PLAYER, amount: 0, accepts: [ItemTypes.POT, ItemTypes.OPPONENT] },\n      ]\n    );\n  }\n\n  if (state.trial === null) {\n    console.log('ultimatum starting...');\n    startTask();\n    return;\n  }\n\n  // If persons are less than the number of trials it should fill the array\n  var personIndex = state.trial;\n  if (state.trial !== null && state.trial >= shuffledPersons.length) {\n    personIndex = state.trial % shuffledPersons.length;\n  }\n\n  /**\n   * render a dialog that shows trial summary.\n   */\n  const renderDialog = () => {\n    return (\n      <Dialog\n        open={state.dialogIsOpen}\n        onClose={() => setState({ ...state, dialogIsOpen: false })}\n        disableEscapeKeyDown\n        aria-labelledby=\"dialog-title\"\n      >\n        {/* // fix error h6 is nested in h2 */}\n        <DialogTitle disableTypography id=\"dialog-title\">\n          <Typography variant='h6' color={state.trialResponses[state.trialResponses.length - 1].result==='accepted'?'primary':'error'}>\n            <b>\n            {state.trialResponses[state.trialResponses.length - 1].result==='accepted' ? \n              t('ultimatum.dialog_title.accepted')\n              :t('ultimatum.dialog_title.rejected')\n            }\n            </b>\n          </Typography>\n        </DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            {t('ultimatum.trial_score_report', {decision: state.trialResponses[state.trialResponses.length - 1].result, score: state.trialResponses[state.trialResponses.length - 1].score })}\n            {t('ultimatum.total_score_report', { score: state.trialResponses.map(r => r.score).reduce((a, b) => a + b, 0) })}\n            <br /> <br />\n            {!state.finished && dialogOptionalText ? t(dialogOptionalText) : t('ultimatum.dialog_optional_text_default')}\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setState({ ...state, dialogIsOpen: false })} color=\"primary\" autoFocus size='large'>\n            {state.trial <= trials - 1 ? t('ultimatum.next_trial') : t('next')}\n          </Button>\n        </DialogActions>\n      </Dialog>\n    );\n  }  \n\n  const isTouchScreen = () => {\n    return ( 'ontouchstart' in window ) ||\n           ( navigator.maxTouchPoints > 0 ) ||\n           ( navigator.msMaxTouchPoints > 0 );\n  }\n  const dndBackend = isTouchScreen() ? TouchBackend : HTML5Backend;\n  /***\n   * Main render part of the ultimatum experiment\n   *\n   */\n  return (\n    <Fragment>\n      {state.dialogIsOpen && renderDialog() }\n      <Grid container direction='column' spacing={2} alignItems='stretch' justifyContent='flex-start' className='ultimatum-container'>\n        <Grid item>\n          <Typography variant=\"body2\">{t(text)}</Typography>\n        </Grid>\n        {/* Boxes container */}\n        <Grid item container spacing={2} alignItems='stretch' justifyContent='space-between' className='boxes-container'>\n          <DndProvider backend={dndBackend} options={isTouchScreen()?{enableMouseEvents: true}:{}}>\n            {boxes.map(({name, amount, accepts}, index) => (\n              <RepositoryBox\n                accept={accepts}\n                name={name}\n                amount={amount}\n                onDrop={(item) => handleDrop(name, item)}\n                key={index}\n                person={shuffledPersons[personIndex]}\n                personsPrefix={personsPrefix}\n              />\n            ))}\n          </DndProvider>\n        </Grid>\n        {/* Labels and actions */}\n        <Grid item container direction='row' justifyContent=\"space-around\" alignItems='center'>\n          <Grid item xs={4}><Grid container direction='column' justifyContent=\"space-around\" alignItems='center'>\n            <Typography  variant='body2'>{t('ultimatum.trial_label',{trial:state.trial+1, trials:trials})}</Typography>\n          </Grid></Grid>\n\n          <Grid item xs={4}><Grid container direction='column' justifyContent=\"space-around\" alignItems='center'>\n            <Button size='large' color={canFinishTrial()?'primary':'default'} variant={canFinishTrial()?'contained':'outlined'} onClick={finishTrialAction}>{t('ultimatum.finish.button')}</Button>\n          </Grid></Grid>\n\n          <Grid item xs={4}><Grid container direction='column' justifyContent=\"space-around\" alignItems='center'>\n            <Typography variant=\"body2\">{t('ultimatum.total_points',{score:state.totalScore})}</Typography>\n          </Grid></Grid>\n        </Grid>\n      </Grid>\n    </Fragment>\n  );\n}\n","import React, { useEffect, useState, Fragment, useCallback } from 'react';\nimport { Typography, Button, Grid, Dialog, DialogTitle, DialogContent, \n          DialogContentText, DialogActions } from '@material-ui/core';\nimport { DndProvider } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport { TouchBackend } from 'react-dnd-touch-backend';\nimport { useTranslation } from 'react-i18next';\nimport { shuffle } from './utils/random';\nimport { ItemTypes, RepositoryBox } from './components/allotmentBox';\n\n//css\nimport \"./dictator.css\";\n\nexport default function Dictator({ content, onStore, onNotification }) {\n\n  const { t } = useTranslation();\n  const { tokens, trials, useOpponentTypes, opponentTypes, text, personsPrefix, persons } = content;\n\n  //const theme = (languages[lang].direction === 'rtl') ? rtlTheme : ltrTheme;\n  //const classes = useStyles(theme);\n\n  const [state, setState] = useState({\n    finished: false,\n    trial: null,\n    totalScore: 0,\n    dialogIsOpen: false,\n    trialResponses: [],\n    taskStartedAt: Date.now(),\n  });\n  const [boxes, setBoxes] = useState(\n    [\n      { name: ItemTypes.OPPONENT, amount: 0, accepts: [ItemTypes.POT, ItemTypes.PLAYER] },\n      { name: ItemTypes.POT, amount: tokens, accepts: [ItemTypes.PLAYER, ItemTypes.OPPONENT] },\n      { name: ItemTypes.PLAYER, amount: 0, accepts: [ItemTypes.POT, ItemTypes.OPPONENT] },\n    ]\n  )\n  const [shuffledPersons, setShuffledPersons] = useState(undefined);\n\n  // on mount and unmount\n  useEffect(() => {\n    // Nothing yet\n  }, []);\n\n  // when finished, store responses and proceed to the next view\n  useEffect(() => {\n    if (state.finished && !state.dialogIsOpen) {\n      const now = Date.now()\n      // add timestamps\n      let response = { trials: state.trialResponses };\n      response.taskStartedAt = state.taskStartedAt;\n      response.taskFinishedAt = now;\n      response.taskDuration = now - state.taskStartedAt;\n      onStore({\n        'view': content,\n        'response': response\n      }, true); // store + next\n    }\n  }, [state, onStore, content]);\n\n /**\n   * Filters persons to return only the persons that have any of the given tags \n   * @param {*persons} persons persons to be filtered by their tags\n   * @param {*} tags tags used to select the persons which their tags has at least one the tags given\n   * @returns \n   */\n  const filterPersonsByTags = (persons, tags) => {\n    if (useOpponentTypes !== true)\n      return persons;\n    const filterredPersons = persons.filter(person => { return checkPersonHasTags(person, tags) });\n      return filterredPersons;\n  }\n\n  /**\n   * Checks if the given person has any of the the given tags\n   * @returns true if the person has any of the given tags\n   */\n  function checkPersonHasTags(person, tags) {\n    var checkResult = false;\n    for (let i = 0; i < person.tags.length; i++) {\n      if (tags.inclue(person.tags[i]))\n        checkResult = true;\n    }\n    return checkResult;\n  }\n\n  const finishTrialAction = () => {\n    canFinishTrial() ? newTrial() : onNotification(t('dictator.errors.required'));\n  }\n\n  /***\n   * this function shows if this trial can be finished by the participant\n   */\n  const canFinishTrial = () => {\n    let result = false;\n    boxes.forEach((box) => {\n      if (box.name === ItemTypes.POT && box.amount === 0)\n        result = true;\n    });\n    return result;\n  }\n\n  /***\n   * Activated when player has droped a token (item that is dragged and name of the dropped box) by setting setBoxes\n   */\n  const handleDrop = useCallback(\n    (name, item) => {\n      // item is the entity that is dropped and has {name, boxName}\n      // name is the name of the repositoryBox that entity has been dropped into\n      const fromBox = item.boxName;\n      const destBox = name;\n      //console.log('dropped on: ',destBox);\n      //console.log('from : ',fromBox);\n      setBoxes(boxes.map(item => {\n        if (item.name === fromBox) {\n          return { ...item, amount: item.amount - 1 };\n        } else if (item.name === destBox) {\n          return { ...item, amount: item.amount + 1 };\n        } else {\n          return item;\n        }\n      }));\n    },\n    [boxes],\n  )\n\n  /***\n   * Starts the task for the first time\n   */\n  const startTask = () => {\n    let filterredPersons = filterPersonsByTags(persons, opponentTypes);\n    setShuffledPersons(shuffle(filterredPersons));\n    setState({\n      ...state,\n      trial: 0,\n      trialResponses: [],\n      taskStartedAt: Date.now() //timestamp\n    });\n  }\n\n  /**\n   * Store trial responses, then proceed to the next trial or finish the game\n   */\n  const newTrial = () => {\n    if (!canFinishTrial()) {\n      console.log('it should never come to this, because before calling newTrial, canFinishTrial has been checked!!!!');\n      onNotification(t('dictator.errors.required'));\n      return;\n    }\n    const playerShare = boxes.find(box => box.name === ItemTypes.PLAYER).amount;\n    setState({\n      ...state,\n      trialResponses: [...state.trialResponses, {\n        trial: state.trial,\n        playerShare: playerShare,\n        opponentShare: tokens - playerShare,\n        opponent: shuffledPersons[personIndex]\n      }],\n      finished: (state.trial >= trials - 1),\n      trial: state.trial + 1,\n      totalScore: state.totalScore + playerShare,\n      dialogIsOpen: true,\n    });\n\n    // when the trial finished the tokens in boxes should reset\n    setBoxes(\n      [\n        { name: ItemTypes.OPPONENT, amount: 0, accepts: [ItemTypes.POT, ItemTypes.PLAYER] },\n        { name: ItemTypes.POT, amount: tokens, accepts: [ItemTypes.PLAYER, ItemTypes.OPPONENT] },\n        { name: ItemTypes.PLAYER, amount: 0, accepts: [ItemTypes.POT, ItemTypes.OPPONENT] },\n      ]\n    );\n  }\n\n  if (state.trial === null) {\n    console.log('dictator starting...');\n    startTask();\n    return;\n  }\n\n  // If persons are less than the number of trials it should fill the array\n  var personIndex = state.trial;\n  if (state.trial !== null && state.trial >= shuffledPersons.length) {\n    personIndex = state.trial % shuffledPersons.length;\n  }\n\n  /**\n   * render a dialog that shows trial summary.\n   */\n  const renderDialog = () => {\n    return (\n      <Dialog\n        open={state.dialogIsOpen}\n        onClose={() => setState({ ...state, dialogIsOpen: false })}\n        disableEscapeKeyDown\n        aria-labelledby=\"dialog-title\"\n      >\n        <DialogTitle id=\"dialog-title\"><b>{t('dictator.dialog_title')}</b></DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            {t('dictator.trial_score_report', { score: state.trialResponses[state.trialResponses.length - 1].playerShare })}\n            {t('dictator.total_score_report', { score: state.trialResponses.map(r => r.playerShare).reduce((a, b) => a + b, 0) })}\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setState({ ...state, dialogIsOpen: false })} color=\"primary\" autoFocus size='large'>\n            {state.trial <= trials - 1 ? t('dictator.next_trial') : t('next')}\n          </Button>\n        </DialogActions>\n      </Dialog>\n    );\n  }\n\n  const isTouchScreen = () => {\n    return ( 'ontouchstart' in window ) ||\n           ( navigator.maxTouchPoints > 0 ) ||\n           ( navigator.msMaxTouchPoints > 0 );\n  }\n  const dndBackend = isTouchScreen() ? TouchBackend : HTML5Backend;\n\n  /***\n   * Main render part of the dictator experiment\n   *\n   */\n  return (\n    <Fragment>\n      {state.dialogIsOpen && renderDialog() }\n      <Grid container direction='column' spacing={2} alignItems='stretch' justifyContent='flex-start' className='dictator-container'>\n        <Grid item>\n          <Typography variant=\"body2\">{t(text)}</Typography>\n        </Grid>\n        {/* Boxes container */}\n        <Grid item container spacing={2} alignItems='stretch' justifyContent='space-between' className='boxes-container'>\n          <DndProvider backend={dndBackend} options={isTouchScreen()?{enableMouseEvents: true}:{}}>\n            {boxes.map(({name, amount, accepts}, index) => (\n              <RepositoryBox\n                accept={accepts}\n                name={name}\n                amount={amount}\n                onDrop={(item) => handleDrop(name, item)}\n                key={index}\n                person={shuffledPersons[personIndex]}\n                personsPrefix={personsPrefix}\n              />\n            ))}\n          </DndProvider>\n        </Grid>\n        {/* Labels and actions */}\n        <Grid item container direction='row' justifyContent=\"space-around\" alignItems='center'>\n          <Grid item xs={4}><Grid container direction='column' justifyContent=\"space-around\" alignItems='center'>\n            <Typography variant='body2'>{t('dictator.trial_label',{trial:state.trial+1, trials:trials})}</Typography>\n          </Grid></Grid>\n\n          <Grid item xs={4}><Grid container direction='column' justifyContent=\"space-around\" alignItems='center'>\n            <Button size='large' color='primary' variant='outlined' onClick={finishTrialAction}>{t('dictator.finish.button')}</Button>\n          </Grid></Grid>\n\n          <Grid item xs={4}><Grid container direction='column' justifyContent=\"space-around\" alignItems='center'>\n            <Typography variant=\"body2\">{t('dictator.total_points',{score:state.totalScore})}</Typography>\n          </Grid></Grid>\n        </Grid>\n      </Grid>\n    </Fragment>\n  );\n}","import React, { useState, useEffect, Fragment } from 'react';\n\n\nimport { Button, Grid, Divider } from '@material-ui/core';\n\nimport {\n  Star,\n  RadioButtonUnchecked as Circle,\n  Add,\n  Check as Correct,\n  Clear as Incorrect\n} from '@material-ui/icons';\n\nimport Markdown from 'react-markdown/with-html';\n\nimport { shuffle } from './utils/random';\nimport { useTranslation } from 'react-i18next';\n\nimport './taskswitch.css';\n\n//FIXME these are realtime variables, so I keep them out of the component's state.\nlet clock\n\nexport default function TaskSwitch({ content, onStore, onProgress }) {\n\n  const { t } = useTranslation();\n  const { text, trials, stimuliDuration, fixationDuration, timeoutsBeforeReset, feedbackDuration } = content;\n\n  const [state, setState] = useState({\n    finished: false,\n    trialResponses: [],\n    taskStartedAt: null,\n    taskFinishedAt: null,\n    taskDuration: null,\n    step: null,\n    type: null,\n    correct: null,\n    stimuli: null,\n    trialStartedAt: null,\n    respondedAt: null,\n    trial: null,\n    timeouts: 0\n  })\n\n\n  useEffect(() => {\n    /**\n     * callback to handle keypress events\n     */\n    const handleKeyPress = (event) => {\n      const { key, keyCode } = event;\n\n      // press space to start the task\n      if (state.trial === null && (keyCode === 32 || key === ' ')) {\n        startTask()\n        return;\n      }\n\n      // ignore invalid keys and invalid trial steps\n      if (state.step !== 'stimuli' || !['ArrowLeft', 'ArrowRight'].includes(key))\n        return;\n\n      const current = state.stimuli[state.trial - 1];\n      let choice = undefined;\n\n      let empty = (key==='ArrowLeft' && current.startsWith('right')) || \n                  (key==='ArrowRight' && current.startsWith('left'));\n      let go = (key==='ArrowLeft' && current.startsWith('left-go')) ||\n              (key==='ArrowRight' && current.startsWith('right-go'));\n\n      choice = current.endsWith('top') ? \n          (go?trials.top.choices.go : (empty?'empty':trials.top.choices.nogo) )\n          :\n          (go?trials.bottom.choices.go : (empty?'empty':trials.bottom.choices.nogo)) ;\n      handleResponse(choice)\n    }\n    \n    window.addEventListener('keydown', handleKeyPress);\n\n    return () => {\n      window.removeEventListener('keydown', handleKeyPress);\n    };\n\n  }, [state] // FIXME add missin dependencies\n  );\n\n  useEffect(() => {\n    // generate stimuli stream\n    if (state.stimuli===null) {\n      let stim = [...Array(trials.total).keys()].map((i,t) => {\n        if(i<trials.top.total){\n          if(i<trials.top.leftGo)\n            return 'left-go-top'\n          if (i<trials.top.go)\n            return 'right-go-top'\n          if (i<trials.top.go + (trials.top.left - trials.top.leftGo))\n            return 'left-nogo-top'\n          return 'right-nogo-top'\n        }else{\n          if(i<trials.top.total+trials.bottom.leftGo)\n            return 'left-go-bottom'\n          if(i<trials.top.total+trials.bottom.go)\n            return 'right-go-bottom'\n          if (i<trials.top.total+ trials.bottom.go + (trials.bottom.left - trials.bottom.leftGo))\n            return 'left-nogo-bottom'\n          return 'right-nogo-bottom'\n        }\n      }); \n      setState({...state, stimuli: shuffle(stim)});\n    }\n  }, [state]);\n\n  useEffect(() => {\n    // # FIXATION\n    if (state.step === 'fixation') {\n      clearTimeout(clock);\n      clock = setTimeout(() => {\n        setState({\n          ...state,\n          trial: state.trial + 1,\n          trialStartedAt: Date.now(),\n          step: 'stimuli'\n        });\n      }, fixationDuration);\n    }\n\n    // # FEEDBACK\n    if (state.step === 'feedback') {\n      clearTimeout(clock);\n      clock = setTimeout(() => {\n        setState({ ...state, step: 'fixation' })\n      }, feedbackDuration)\n    }\n\n    if (state.step === 'stimuli') {\n      clearTimeout(clock);\n\n      if (state.timeouts < timeoutsBeforeReset) {\n        clock = setTimeout(() => {\n          setState({\n            ...state,\n            trialResponses: [...state.trialResponses, {\n              'trial': state.trial,\n              'stimuli': state.stimuli[state.trial - 1],\n              'choice': null,\n              'correct': null,\n              'respondedAt': null,\n              'trialStartedAt': state.trialStartedAt,\n              'rt': null\n            }],\n            timeouts: state.timeouts + 1,\n            correct: false,\n            step: (feedbackDuration > 0) ? 'feedback' : 'fixation'\n          });\n        }, stimuliDuration)\n      } else {\n        setState({ ...state, step: 'reset', timeouts: 0 })\n      }\n    }\n\n\n    onProgress(100.0 * state.trial / trials.total)\n\n    if (state.trial > trials.total) {\n      console.log('------------ FINISHED -------')\n      onProgress(100.0)\n      setState({ ...state, finished: true, taskFinishedAt: Date.now() })\n    }\n\n    // on finish\n    if (state.finished) {\n      clearTimeout(clock);\n\n      // timestamps\n      let response = { trials: state.trialResponses };\n      response.taskStartedAt = state.taskStartedAt;\n      response.taskFinishedAt = state.taskFinishedAt;\n      response.taskDuration = state.taskFinishedAt - state.taskStartedAt;\n      onStore({\n        'view': content,\n        'response': response\n      }, true); // store + next\n    }\n\n  }, [state]);\n\n\n  const startTask = () => {\n    setState({\n      ...state,\n      trialResponses: [],\n      trial: 0,\n      timeouts: 0,\n      step: 'fixation',\n      taskStartedAt: Date.now()\n    })\n  }\n\n  const handleResponse = (choice) => {\n    const respondedAt = Date.now(); //timestamp\n\n    clearTimeout(clock);\n\n    const _correct = getCorrect(state.stimuli[state.trial - 1]);\n    console.log('correct answer = %s for choice %s , in stimuli %o', _correct, choice, state.stimuli[state.trial - 1]);\n\n    setState({\n      ...state,\n      correct: _correct === choice,\n      respondedAt: respondedAt,\n      trialResponses: [...state.trialResponses, {\n        'trial': state.trial,\n        'stimuli': state.stimuli[state.trial - 1],\n        'choice': choice,\n        'correct': _correct === choice,\n        'respondedAt': respondedAt,\n        'trialStartedAt': state.trialStartedAt,\n        'rt': respondedAt - state.trialStartedAt\n      }],\n      step: (feedbackDuration > 0) ? 'feedback' : 'fixation'\n    })\n  }\n\n  function getCorrect(stimuli){\n    const choices = stimuli.endsWith('top') ? trials.top.choices : trials.bottom.choices;\n    return stimuli.includes('nogo') ? 'empty' : choices.go;\n  }\n\n  const renderStimulus = (stimulus, selectable = true) => {\n    return (\n      <Fragment>\n      {stimulus==='empty' && selectable && <div onClick={() => handleResponse('empty')} className='ts-stimulus'> </div>}\n      {stimulus==='empty' && !selectable && <div className='ts-stimulus ts-inactive'> </div>}\n      {stimulus==='star' && <div onClick={() => handleResponse('star')} className='ts-stimulus'><Star fontSize='large' className='yellow' /></div>}\n      {stimulus==='circle' && <div onClick={() => handleResponse('circle')} className='ts-stimulus'><Circle fontSize='large' className='blue' /></div>}\n      {stimulus==='blue-star' && <div onClick={() => handleResponse('blue-star')} className='ts-stimulus'><Star fontSize='large' className='blue' /></div>}\n      {stimulus==='yellow-circle' && <div onClick={() => handleResponse('yellow-circle')} className='ts-stimulus'><Star fontSize='large' className='yellow' /></div>}\n      </Fragment>\n    );\n  }\n\n  /**\n   * \n   * @param {*} trialType type of trial\n   * @param {*} pos 0 for top, 1 for bottom\n   * @returns renders a row of stimuli\n   */\n  const renderStimuliRow = (trialType, pos) =>{\n    const choices = trialType.endsWith('top') ? trials.top.choices : trials.bottom.choices;\n    return (\n      <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n        {pos===0 && trialType.endsWith('bottom') && renderStimulus('empty',false)}\n        {pos===0 && trialType.endsWith('top') && trialType.startsWith('left-go') && renderStimulus(choices.go)}\n        {pos===0 && trialType.endsWith('top') && trialType.startsWith('left-nogo') && renderStimulus(choices.nogo)}\n        {pos===0 && trialType.endsWith('top') && (!trialType.includes('left-go')  && !trialType.includes('left-nogo')) && renderStimulus('empty')}\n        {pos===1 && trialType.endsWith('top') && renderStimulus('empty',false)}\n        {pos===1 && trialType.endsWith('bottom') && trialType.startsWith('left-go') && renderStimulus(choices.go)}\n        {pos===1 && trialType.endsWith('bottom') && trialType.startsWith('left-nogo') && renderStimulus(choices.nogo)}\n        {pos===1 && trialType.endsWith('bottom') && (!trialType.startsWith('left-go') && !trialType.startsWith('left-nogo')) && renderStimulus('empty')}\n        <Divider orientation='vertical' flexItem />\n        {pos===0 && trialType.endsWith('bottom') && renderStimulus('empty',false)}\n        {pos===0 && trialType.endsWith('top') && trialType.startsWith('right-go') && renderStimulus(choices.go)}\n        {pos===0 && trialType.endsWith('top') && trialType.startsWith('right-nogo') && renderStimulus(choices.nogo)}\n        {pos===0 && trialType.endsWith('top') && (!trialType.includes('right-go')  && !trialType.includes('right-nogo')) && renderStimulus('empty')}\n        {pos===1 && trialType.endsWith('top') && renderStimulus('empty',false)}\n        {pos===1 && trialType.endsWith('bottom') && trialType.startsWith('right-go') && renderStimulus(choices.go)}\n        {pos===1 && trialType.endsWith('bottom') && trialType.startsWith('right-nogo') && renderStimulus(choices.nogo)}\n        {pos===1 && trialType.endsWith('bottom') && (!trialType.startsWith('right-go') && !trialType.startsWith('right-nogo')) && renderStimulus('empty')}\n      </Grid>\n    )\n  }\n  const renderStimuli = (trialType) => {\n    //console.log(\"renderStimuli: \",trialType);\n    if(!trialType)\n      return;\n    return (\n      <Grid item container direction='column' spacing={2} alignItems='stretch' justifyContent='flex-start' className='ts-stimulus-container'>\n        {renderStimuliRow(trialType,0)}\n        <Grid item> <Divider orientation='horizontal' /> </Grid>\n        {renderStimuliRow(trialType,1)}\n      </Grid>\n    )\n  }\n\n  const renderFeedback = () => {\n    return (\n      <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n        {state.correct && <Correct fontSize='large' className='correct ts-icon' />}\n        {!state.correct && <Incorrect fontSize='large' className='incorrect ts-icon' />}\n      </Grid>\n    )\n  }\n\n  const renderFixation = () => {\n    return (\n      <Grid item container direction=\"row\" justifyContent=\"space-around\" alignItems=\"center\">\n        <Add fontSize='large' className='fixation ts-icon' />\n      </Grid>\n    );\n  }\n\n  // show reset screen on timeouts reaching a threshold\n  if (state.step === 'reset') {\n    return (\n      <Grid container direction='column' spacing={2} alignItems='center' justifyContent='flex-start' className='Text-container'>\n        <Grid item><Markdown source={t('taskswitch.too_many_timeouts')} escapeHtml={false} className='markdown-text' /></Grid>\n        <Grid item>\n          <Button variant='outlined' color='secondary' onClick={() => startTask()}>{t('taskswitch.restart')}</Button>\n        </Grid>\n      </Grid>\n    )\n  }\n\n  // start screen\n  if (state.trial === null) {\n    return (\n      <Grid container direction='column' spacing={2} alignItems='center' justifyContent='flex-start' className='Text-container'>\n        <Grid item><Markdown source={t('taskswitch.are_you_ready')} escapeHtml={false} className='markdown-text' /></Grid>\n        <Grid item>\n          <Button variant='outlined' onClick={() => startTask()}>{t('taskswitch.start')}</Button>\n        </Grid>\n      </Grid>\n    )\n  }\n\n  return (\n    <Grid item container direction='column' spacing={2} alignItems='stretch' justifyContent='flex-start' className='ts-container'>\n      <Grid item>\n        <Markdown source={t(text)} escapeHtml={false} className='markdown-text' />\n      </Grid>\n\n      {state.step === 'stimuli' && renderStimuli(state.stimuli[state.trial - 1])}\n      {state.step === 'feedback' && renderFeedback()}\n      {state.step === 'fixation' && renderFixation()}\n\n    </Grid>\n  );\n}\n","import React, { useState, useEffect, Fragment } from 'react';\n\n\nimport { Button, Grid, Divider } from '@material-ui/core';\n\nimport {\n  Star,\n  RadioButtonUnchecked as Circle,\n  Add,\n  Check as Correct,\n  Clear as Incorrect\n} from '@material-ui/icons';\n\nimport Markdown from 'react-markdown/with-html';\n\nimport { shuffle } from './utils/random';\nimport { useTranslation } from 'react-i18next';\n\nimport './simplified_taskswitch.css';\n\n//FIXME these are realtime variables, so I keep them out of the component's state.\nlet clock\n\nexport default function SimplifiedTaskSwitch({ content, onStore, onProgress }) {\n\n  const { t } = useTranslation();\n  const { text, trials, stimuliDuration, fixationDuration, timeoutsBeforeReset, feedbackDuration } = content;\n\n  const [state, setState] = useState({\n    finished: false,\n    trialResponses: [],\n    taskStartedAt: null,\n    taskFinishedAt: null,\n    taskDuration: null,\n    step: null,\n    type: null,\n    correct: null,\n    stimuli: null,\n    trialStartedAt: null,\n    respondedAt: null,\n    trial: null,\n    timeouts: 0\n  })\n\n\n  useEffect(() => {\n    console.log('useEffect -> before handleKeyPress, it has no dependency');\n    /**\n     * callback to handle keypress events\n     */\n    const handleKeyPress = (event) => {\n      const { key, keyCode } = event;\n\n      // press space to start the task\n      if (state.trial === null && (keyCode === 32 || key === ' ')) {\n        startTask()\n        return;\n      }\n\n      // ignore invalid keys and invalid trial steps\n      if (state.step !== 'stimuli' || !['ArrowLeft', 'ArrowRight'].includes(key))\n        return;\n\n      const current = state.stimuli[state.trial - 1];\n      let choice = undefined;\n\n      if (key === 'ArrowLeft')\n        choice = current.pos > 1 ? 2 : 0;\n      if (key === 'ArrowRight')\n        choice = current.pos > 1 ? 3 : 1;\n\n      handleResponse(choice)\n\n    }\n    window.addEventListener('keydown', handleKeyPress);\n\n    return () => {\n      window.removeEventListener('keydown', handleKeyPress);\n    };\n  }, [state] // FIXME add missin dependencies\n  );\n\n  useEffect(() => {\n\n    console.log(state.stimuli);\n    // generate stimuli stream : stimuli:{pos: [0 top-left, 1 top-right, 2 bott-left, 3 bott-right]  , figure:'figureA/B' , color: 'blue/yellow }\n    if (state.stimuli === null) {\n      let stim = [...Array(trials.total).keys()].map((i, t) => {\n        let stimuliProperties = {\n          pos: 0, // 0 top-left, 1 top-right, 2 bott-left, 3 bott-right]\n          figure: 0, // 0 'figureA' , 1 'figureB' color: 'blue/yellow }\n          color: 0 // 0 colorA , 1 colorB\n        };\n        if (i < trials.typeA) {\n          stimuliProperties.pos = (i < trials.left) ? 0 : 1;\n          stimuliProperties.figure = i < trials.figureA ? 0 : 1;\n          stimuliProperties.color = i < trials.colorA ? 0 : 1;\n        } else {\n          stimuliProperties.pos = (i - trials.typeA) < trials.left ? 2 : 3;\n          stimuliProperties.figure = (i - trials.typeA) < trials.figureA ? 0 : 1;\n          stimuliProperties.color = (i - trials.typeA) < trials.colorA ? 0 : 1;\n        }\n        return stimuliProperties;\n      })\n      setState({ ...state, stimuli: shuffle(stim) });\n    }\n  }, [state.stimuli]);\n\n  useEffect(() => {\n    // # FIXATION\n    if (state.step === 'fixation') {\n      clearTimeout(clock);\n      clock = setTimeout(() => {\n        setState({\n          ...state,\n          trial: state.trial + 1,\n          trialStartedAt: Date.now(),\n          step: 'stimuli'\n        });\n      }, fixationDuration);\n    }\n\n    // # FEEDBACK\n    if (state.step === 'feedback') {\n      clearTimeout(clock);\n      clock = setTimeout(() => {\n        setState({ ...state, step: 'fixation' })\n      }, feedbackDuration)\n    }\n\n    if (state.step === 'stimuli') {\n      clearTimeout(clock);\n\n      if (state.timeouts < timeoutsBeforeReset) {\n        clock = setTimeout(() => {\n          setState({\n            ...state,\n            trialResponses: [...state.trialResponses, {\n              'trial': state.trial,\n              'stimuli': state.stimuli[state.trial - 1],\n              'choice': null,\n              'correct': null,\n              'respondedAt': null,\n              'trialStartedAt': state.trialStartedAt,\n              'rt': null\n            }],\n            timeouts: state.timeouts + 1,\n            correct: false,\n            step: (feedbackDuration > 0) ? 'feedback' : 'fixation'\n          });\n        }, stimuliDuration)\n      } else {\n        setState({ ...state, step: 'reset', timeouts: 0 })\n      }\n    }\n\n\n    onProgress(100.0 * state.trial / trials.total)\n\n    if (state.trial > trials.total) {\n      console.log('------------ FINISHED -------')\n      onProgress(100.0)\n      setState({ ...state, finished: true, taskFinishedAt: Date.now() })\n    }\n\n    // on finish\n    if (state.finished) {\n      clearTimeout(clock);\n\n      // timestamps\n      let response = { trials: state.trialResponses };\n      response.taskStartedAt = state.taskStartedAt;\n      response.taskFinishedAt = state.taskFinishedAt;\n      response.taskDuration = state.taskFinishedAt - state.taskStartedAt;\n      onStore({\n        'view': content,\n        'response': response\n      }, true); // store + next\n    }\n\n  }, [state]);\n\n\n  const startTask = () => {\n    setState({\n      ...state,\n      trialResponses: [],\n      trial: 0,\n      timeouts: 0,\n      step: 'fixation',\n      taskStartedAt: Date.now()\n    })\n  }\n\n  const handleResponse = (choice) => {\n    const respondedAt = Date.now(); //timestamp\n\n    clearTimeout(clock);\n\n    const _correct = getCrorrectFromStimuli(state.stimuli[state.trial - 1]);\n    console.log('correct answer = %d for choice %d , in stimuli %o', _correct, choice, state.stimuli[state.trial - 1]);\n\n    setState({\n      ...state,\n      correct: _correct === choice,\n      respondedAt: respondedAt,\n      trialResponses: [...state.trialResponses, {\n        'trial': state.trial,\n        'stimuli': state.stimuli[state.trial - 1],\n        'type': state.stimuli[state.trial - 1].pos < 2 ? 0 : 1,\n        'choice': choice,\n        'correct': _correct === choice,\n        'respondedAt': respondedAt,\n        'trialStartedAt': state.trialStartedAt,\n        'rt': respondedAt - state.trialStartedAt\n      }],\n      step: (feedbackDuration > 0) ? 'feedback' : 'fixation'\n    })\n  }\n\n  function getCrorrectFromStimuli(stimuli) {\n    if (stimuli.pos < 2) {\n      if (stimuli.figure === 0)\n        return stimuli.pos;\n      return 1 - stimuli.pos;\n    }\n    if (stimuli.pos > 1) {\n      if (stimuli.color === 0)\n        return stimuli.pos;\n      return stimuli.pos === 2 ? 3 : 2;\n    }\n  }\n\n  const renderStimulus = (stimulus, pos) => {\n    return (\n      <Fragment>\n        <div onClick={() => handleResponse(pos)} className='ts-stimulus'>\n          {stimulus === '0-0' && <Star fontSize='large' className='yellow' />}\n          {stimulus === '1-0' && <Circle fontSize='large' className='yellow' />}\n          {stimulus === '0-1' && <Star fontSize='large' className='blue' />}\n          {stimulus === '1-1' && <Circle fontSize='large' className='blue' />}\n        </div>\n      </Fragment>\n    );\n  }\n\n  const renderStimuliRow = (draw, stimuli, i, j) => {\n    if (draw === false)\n      return (\n        <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n          {renderStimulus('empty', i)}\n          <Divider orientation='vertical' flexItem />\n          {renderStimulus('empty', j)}\n        </Grid>\n      );\n    return (\n      <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n        {stimuli?.pos === i && renderStimulus(stimuli.figure + '-' + stimuli.color, stimuli.pos)}\n        {stimuli?.pos === j && renderStimulus('empty', i)}\n        <Divider orientation='vertical' flexItem />\n        {stimuli?.pos === i && renderStimulus('empty', j)}\n        {stimuli?.pos === j && renderStimulus(stimuli.figure + '-' + stimuli.color, stimuli.pos)}\n      </Grid>\n    )\n  }\n  const renderStimuli = (stimuli) => {\n    return (\n      <Grid item container direction='column' spacing={2} alignItems='stretch' justifyContent='flex-start' className='ts-stimulus-container'>\n        {stimuli?.pos < 2 && renderStimuliRow(true, stimuli, 0, 1)}\n        {stimuli?.pos > 1 && renderStimuliRow(false)}\n        <Grid item> <Divider orientation='horizontal' /> </Grid>\n        {stimuli?.pos < 2 && renderStimuliRow(false)}\n        {stimuli?.pos > 1 && renderStimuliRow(true, stimuli, 2, 3)}\n      </Grid>\n    )\n  }\n\n  const renderFeedback = () => {\n    return (\n      <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n        {state.correct && <Correct fontSize='large' className='correct ts-icon' />}\n        {!state.correct && <Incorrect fontSize='large' className='incorrect ts-icon' />}\n      </Grid>\n    )\n\n  }\n\n  const renderFixation = () => {\n    return (\n      <Grid item container direction=\"row\" justifyContent=\"space-around\" alignItems=\"center\">\n        <Add fontSize='large' className='fixation ts-icon' />\n      </Grid>\n    );\n  }\n\n  // show reset screen on timeouts reaching a threshold\n  if (state.step === 'reset') {\n    return (\n      <Grid container direction='column' spacing={2} alignItems='center' justifyContent='flex-start' className='Text-container'>\n        <Grid item><Markdown source={t('taskswitch.too_many_timeouts')} escapeHtml={false} className='markdown-text' /></Grid>\n        <Grid item>\n          <Button variant='outlined' color='secondary' onClick={() => startTask()}>{t('taskswitch.restart')}</Button>\n        </Grid>\n      </Grid>\n\n    )\n  }\n\n  // start screen\n  if (state.trial === null) {\n    return (\n      <Grid container direction='column' spacing={2} alignItems='center' justifyContent='flex-start' className='Text-container'>\n        <Grid item><Markdown source={t('taskswitch.are_you_ready')} escapeHtml={false} className='markdown-text' /></Grid>\n        <Grid item>\n          <Button variant='outlined' onClick={() => startTask()}>{t('taskswitch.start')}</Button>\n        </Grid>\n      </Grid>\n    )\n  }\n\n  return (\n    <Grid item container direction='column' spacing={2} alignItems='stretch' justifyContent='flex-start' className='ts-container'>\n      <Grid item>\n        <Markdown source={t(text)} escapeHtml={false} className='markdown-text' />\n      </Grid>\n\n      {state.step === 'stimuli' && renderStimuli(state.stimuli[state.trial - 1])}\n      {state.step === 'feedback' && renderFeedback()}\n      {state.step === 'fixation' && renderFixation()}\n\n    </Grid>\n  );\n}\n","import React, { useEffect, useState, Fragment } from 'react';\nimport { Box, Button, Grid, Typography } from '@material-ui/core';\nimport { useTranslation } from 'react-i18next';\nimport Markdown from 'react-markdown/with-html';\nimport { \n  Star, \n  RadioButtonUnchecked as Circle,\n  CheckBoxOutlineBlank as Rectangle,\n  ChangeHistory as Triangle,\n  PanTool as Hand,\n  SportsSoccer as Ball,\n  Watch,\n  School,\n  FreeBreakfast as Cup,\n  Block,\n  Check as Correct,\n  Clear as Incorrect,\n  Add\n} from '@material-ui/icons';\nimport { shuffle } from './utils/random';\n\n//css\nimport \"./nback.css\";\n\n//FIXME these are realtime variables, so I keep them out of the component's state.\nlet clock\n\nexport default function NBack({content, onStore, onNotification, onProgress}) {\n  //props: title, text  \n  \n  const { t } = useTranslation();\n  \n  const { text, trials, stimuliDuration, fixationDuration, feedbackDuration, nback, stimuli } = content;\n  \n  const _noresponse = 'noresponse';\n\n  const iconFigures = {\n    star: Star,\n    circle: Circle,\n    triangle: Triangle,\n    rectangle: Rectangle,\n    hand: Hand,\n    ball: Ball,\n    watch: Watch,\n    school: School,\n    cup: Cup\n  };\n\n  const [state, setState] = useState({\n    finished: false,\n    trial: null,\n    step: null,\n    trialResponses: [],\n    taskStartedAt: null,\n    taskFinishedAt: null,\n    taskDuration: null,\n    trialStartedAt: null,\n    respondedAt: null,\n    stimuli: null\n  });\n\n  useEffect(() => {\n    /**\n     * callback to handle keypress events\n     */\n    const handleKeyPress = (event) => {\n      const { key, keyCode } = event;\n\n      // press space to start the task\n      if (state.trial === null && (keyCode===32 || key===' ')) {\n        startTask()\n        return;\n      }\n\n      // ignore invalid keys and invalid trial steps\n      if (state.step !== 'stimuli' || !(keyCode === 32 || key === ' '))\n        return;\n\n      const current = state.stimuli[state.trial - 1];\n      handleResponse(current);\n    }\n    window.addEventListener('keydown', handleKeyPress);\n\n    return () => {\n      window.removeEventListener('keydown', handleKeyPress);\n    };\n\n  },[state]);\n\n  useEffect(() => {\n    // console.log(\"use effect for generating stimuli: \", state.stimuli);\n    // generate stimuli stream\n    if (state.stimuli===null) {\n      let figureIndex = 0;\n      let figureTotal =0;\n      let stim = [...Array(trials).keys()].map((i,t) => {\n        let figure = stimuli[figureIndex];\n        if(figureTotal<figure.amount){\n          figureTotal++;\n          return {\"type\": figure.type, \"name\": figure.name};\n        }else{\n          figureIndex++;\n          figureTotal = 1;\n          if(figureIndex>=stimuli.length){\n            console.log('error in figure numbers and total trials, reseting figures. Index: %d , length: %d', figureIndex, stimuli?.length);\n            figureIndex = 0;\n          }\n          figure = stimuli[figureIndex];\n          return {\"type\": figure.type, \"name\": figure.name};\n        }\n      });\n      setState({...state, stimuli: shuffle(stim)});\n    }\n\n    // check if it is finished\n    if (state.trial > trials) {\n      console.log('------------ FINISHED -------')\n      onProgress(100.0)\n      setState({ ...state, finished: true, taskFinishedAt: Date.now() })\n    }\n\n    // # FIXATION\n    if (state.step === 'fixation') {\n      clearTimeout(clock);\n      clock = setTimeout(() => {\n        setState({\n          ...state,\n          trial: state.trial + 1,\n          trialStartedAt: Date.now(),\n          step: 'stimuli'\n        });\n      }, fixationDuration);\n    }\n    \n    // # FEEDBACK\n    if (state.step === 'feedback') {\n      clearTimeout(clock);\n      clock = setTimeout(() => {\n        setState({ ...state, step: 'fixation' })\n      }, feedbackDuration)\n    }\n\n    // # STIMULI\n    if (state.step === 'stimuli') {\n      clearTimeout(clock); \n      clock = setTimeout(() => {\n        const respondedAt = Date.now(); //timestamp\n        //console.log(\"trial: %d  - stimulus: %o\",state.trial,state.stimuli[state.trial-1]);\n        const _correct = state.trial>nback ? state.stimuli[state.trial - 1]?.name!==state.stimuli[state.trial - (nback+1)]?.name : true ;\n        setState({\n          ...state,\n          correct: _correct,\n          respondedAt: respondedAt,\n          trialResponses: [...state.trialResponses, {\n            'trial': state.trial,\n            'stimuli': state.stimuli[state.trial - 1],\n            'choice': _noresponse,\n            'correct': _correct,\n            'respondedAt': respondedAt,\n            'trialStartedAt': state.trialStartedAt,\n            'rt': null\n          }],\n          step: (feedbackDuration > 0) ? 'feedback' : 'fixation'\n        });\n      }, stimuliDuration)\n    }\n\n    // Set progress\n    onProgress(100.0 * state.trial / trials)\n\n    // on finish\n    if (state.finished) {\n      clearTimeout(clock);\n\n      // timestamps\n      let response = { trials: state.trialResponses };\n      response.taskStartedAt = state.taskStartedAt;\n      response.taskFinishedAt = state.taskFinishedAt;\n      response.taskDuration = state.taskFinishedAt - state.taskStartedAt;\n      onStore({\n        'view': content,\n        'response': response\n      }, true); // store + next\n    }\n\n  }, [state] );\n\n  /**\n   * Starts the task\n   */\n  const startTask = () => {\n    setState({\n      ...state,\n      trialResponses: [],\n      trial: 0,\n      step: 'fixation',\n      taskStartedAt: Date.now()\n    })\n    console.log('task started. stimuli: %o', state.stimuli);\n  }\n\n  /**\n   * handles user response\n   * @param {*} selected \n   */\n  const handleResponse = (selected) => {\n    if(state.trial<=nback){\n      return onNotification(t('nback.invalid.selection.notification'));\n    }\n\n    const respondedAt = Date.now(); //timestamp\n    clearTimeout(clock);\n\n    //console.log(\"trial: %d  - stimulus: %o  -  selected: %o\",state.trial,state.stimuli[state.trial-1],selected);\n    //if(state.trial>nback)\n    // console.log(\"stimulus1 : %o  -  stimulus2 : %o  -  comp result: %s\",state.stimuli[state.trial - 1],state.stimuli[state.trial - (nback+1)],state.stimuli[state.trial - 1].name!==state.stimuli[state.trial - (nback+1)].name);\n\n    const _correct = state.trial>nback ? state.stimuli[state.trial - 1]?.name===state.stimuli[state.trial - (nback+1)]?.name : false ;\n\n    setState({\n      ...state,\n      correct: _correct,\n      respondedAt: respondedAt,\n      trialResponses: [...state.trialResponses, {\n        'trial': state.trial,\n        'stimuli': state.stimuli[state.trial - 1],\n        'choice': selected,\n        'correct': _correct,\n        'respondedAt': respondedAt,\n        'trialStartedAt': state.trialStartedAt,\n        'rt': respondedAt - state.trialStartedAt\n      }],\n      step: (feedbackDuration > 0) ? 'feedback' : 'fixation'\n    });\n    //console.log('handle resp: %o , after setState', selected);\n  }\n\n  /**\n   * Renders the given stimulus, if type is icon it uses iconFigures to render, and if type is letter it uses Typography element\n   * @param {*} stimulus \n   * @returns html element of the stimuli\n   */\n  const renderStimulus = (stimulus) => {\n    console.log('renderFigure: ',stimulus);\n    if(stimulus===null || stimulus===undefined){\n      console.log('figure is null, state:',state);\n      return(\n        <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n        </Grid>\n      )\n    }\n    if(stimulus.type===\"icon\"){\n      if(!iconFigures[stimulus.name]){\n        return(\n          <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n            <Fragment>\n              <Box onClick={() => handleResponse(stimulus)} className='single-stimulus single-stimulus-icon'>\n                <Block fontSize='large' className='yellow single-stimulus-icon' />\n              </Box>\n            </Fragment>\n          </Grid>\n        );\n      }\n      const FigureCompoentnt = iconFigures[stimulus.name];\n      return(\n        <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n          <Box onClick={() => handleResponse(stimulus)} className='single-stimulus single-stimulus-icon'>\n            <FigureCompoentnt fontSize='large' className='yellow single-stimulus-icon' />\n          </Box>\n        </Grid>\n      );\n    }else if(stimulus.type===\"letter\"){\n      return(\n        <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n          <Box onClick={() => handleResponse(stimulus)} className='single-stimulus single-stimulus-letter' textAlign=\"center\">\n            <Typography type='span' className='yellow single-stimuli-letter'> {stimulus.name} </Typography>\n          </Box>\n        </Grid>\n      );\n    }\n  }\n\n  /**\n   * Renders feedback\n   */\n  const renderFeedback = () => {\n    return (\n      <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n        {state.correct && <Correct fontSize='large' className='correct single-stimulus-icon' />}\n        {!state.correct && <Incorrect fontSize='large' className='incorrect single-stimulus-icon' />}\n      </Grid>\n    )\n  }\n\n  /**\n   * Renders fixation element\n   */\n  const renderFixation = () => {\n    return (\n      <Grid item container direction=\"row\" justifyContent=\"space-around\" alignItems=\"center\">\n        <Add fontSize='large' className='stimulus-fixation single-stimulus-icon' />\n      </Grid>\n    );\n  }\n\n  // start screen\n  if (state.trial === null) {\n    return (\n      <Grid container direction='column' spacing={2} alignItems='center' justifyContent='flex-start' className='Text-container'>\n        <Grid item><Markdown source={t('nback.are_you_ready')} escapeHtml={false} className='markdown-text' /></Grid>\n        <Grid item>\n          <Button variant='outlined' onClick={() => startTask()}>{t('nback.start')}</Button>\n        </Grid>\n      </Grid>\n    )\n  }\n\n  return (\n    <Grid container direction='column' spacing={2} alignItems='stretch' justifyContent='flex-start' className='nback-container'>\n      <Grid item>\n        <Markdown source={t(text)} escapeHtml={false} className='markdown-text' />\n      </Grid>\n      <Grid item container direction='row' justifyContent='center' alignItems='center' className='nback-main-container'>\n        {state.step === 'stimuli'  && renderStimulus(state.stimuli[state.trial-1])}\n        {state.step === 'feedback' && state.trial>nback && renderFeedback()}\n        {state.step === 'fixation' && renderFixation()}\n      </Grid>\n    </Grid>\n  );\n}\n","import React, {useState, useEffect, useCallback, Fragment, useRef} from 'react';\n\n\nimport { Button, Grid, Typography, Divider, Box} from '@material-ui/core';\n\nimport { \n  Star, \n  RadioButtonUnchecked as Circle,\n  CheckBoxOutlineBlank as Rectangle,\n  ChangeHistory as Triangle,\n  PanTool as Hand,\n  SportsSoccer as Ball,\n  Watch,\n  School,\n  FreeBreakfast as Cup,\n  Add,\n  Block,\n  Check as Correct,\n  Clear as Incorrect\n} from '@material-ui/icons';\n\nimport Markdown from 'react-markdown/with-html';\n\nimport { sample, shuffle } from './utils/random';\nimport { useTranslation } from 'react-i18next';\n\nimport './gonogoalt.css';\n\n//FIXME these are realtime variables, so I keep them out of the component's state.\nlet clock\n\nexport default function GoNoGoAlt({content, onStore, onProgress, onNotification}) {\n\n  const { t } = useTranslation();\n  const { text, trials, stimuliDuration, fixationDuration, feedbackDuration, choices } = content;\n  const _noresponse = 'noresponse';\n\n  const iconFigures = {\n    star: Star,\n    circle: Circle,\n    triangle: Triangle,\n    rectangle: Rectangle,\n    hand: Hand,\n    ball: Ball,\n    watch: Watch,\n    school: School,\n    cup: Cup\n  }\n\n  const [state, setState] = useState({\n    finished: false,\n    trial: null,\n    step: null,\n    trialResponses: [],\n    taskStartedAt: null,\n    taskFinishedAt: null,\n    taskDuration: null,\n    trialStartedAt: null,\n    respondedAt: null,\n    stimuli: null,\n    correct: null\n  })\n\n  useEffect(() => {\n    /**\n     * callback to handle keypress events\n     */\n    const handleKeyPress = (event) => {\n      const { key, keyCode } = event;\n\n      // press space to start the task\n      if (state.trial === null && (keyCode===32 || key===' ')) {\n        startTask()\n        return;\n      }\n\n      // ignore invalid keys and invalid trial steps\n      if (state.step !== 'stimuli' || !(keyCode === 32 || key === ' '))\n        return;\n\n      const current = state.stimuli[state.trial - 1];\n      handleResponse(current);\n    }\n    window.addEventListener('keydown', handleKeyPress);\n\n    return () => {\n      window.removeEventListener('keydown', handleKeyPress);\n    };\n\n  },[state]);\n\n\n  useEffect(() => {\n\n    // generate stimuli stream\n    if (state.stimuli===null) {\n      console.log(trials);\n      let stim = [...Array(trials.total).keys()].map((i,t) => {\n        if (i<trials.go)\n          return {\"trialType\": \"go\", \"type\": choices.go.type, \"name\":sample(choices.go.names)}\n        else\n          return {\"trialType\": \"nogo\", \"type\": choices.nogo.type, \"name\":sample(choices.nogo.names)}\n      }) \n      setState({...state, stimuli: shuffle(stim)});\n    }\n\n    // # FIXATION\n    if (state.step === 'fixation') {\n      clearTimeout(clock);  \n      clock = setTimeout(() => {\n          setState({\n            ...state, \n            trial: state.trial+1, \n            trialStartedAt: Date.now(), \n            step: 'stimuli'\n          });\n        }, fixationDuration);\n    }\n\n    // # FEEDBACK\n    if (state.step === 'feedback') {\n      clearTimeout(clock);\n      clock = setTimeout(() => {\n          setState({...state, step: 'fixation'})\n        }, feedbackDuration)\n    }\n\n    // # STIMULI\n    if (state.step === 'stimuli') {\n      clearTimeout(clock);\n      clock = setTimeout(() => {\n        const respondedAt = Date.now(); //timestamp\n        console.log('stimuli step timeout. stimuli: %o', state.stimuli[state.trial-1]);\n        const _correct =  state.stimuli[state.trial-1]?.trialType?.endsWith('nogo');\n        setState({\n          ...state,\n          correct: _correct,\n          respondedAt: respondedAt,\n          trialResponses: [...state.trialResponses, {\n            'trial': state.trial,\n            'stimuli': state.stimuli[state.trial-1],\n            'choice': _noresponse,\n            'correct': _correct,\n            'respondedAt': respondedAt,\n            'trialStartedAt': state.trialStartedAt,\n            'rt': null\n          }],\n          step: (feedbackDuration>0)?'feedback':'fixation'\n        });\n      }, stimuliDuration)\n    }\n\n    // Set progress\n    onProgress(100.0 * state.trial / trials.total)\n  \n    // check if task is finished\n    if (state.trial>trials.total) {\n      console.log('------------ FINISHED -------')\n      onProgress(100.0)\n      setState({...state, finished: true, taskFinishedAt: Date.now()})\n    }\n\n    // on finish\n    if (state.finished) {\n      clearTimeout(clock);\n      \n      // timestamps\n      let response = {trials: state.trialResponses};\n      response.taskStartedAt = state.taskStartedAt;\n      response.taskFinishedAt = state.taskFinishedAt;\n      response.taskDuration = state.taskFinishedAt - state.taskStartedAt;\n      onStore({\n        'view': content,\n        'response': response\n      }, true); // store + next\n    }\n\n  },[state]);\n\n  const startTask = () => {\n    setState({\n      ...state, \n      trialResponses: [], \n      trial: 0, \n      step: 'fixation', \n      taskStartedAt: Date.now()\n    })\n    console.log('task started. stimuli: %o', state.stimuli)\n  }\n\n  /**\n   * handles user response\n   * @param {*} selected \n   */\n  const handleResponse = (selected) => {\n    const respondedAt = Date.now(); //timestamp\n    clearTimeout(clock);\n\n    const _correct = !state.stimuli[state.trial-1]?.trialType?.endsWith('nogo')\n\n    setState({\n      ...state,\n      correct: _correct,\n      respondedAt: respondedAt,\n      trialResponses: [...state.trialResponses, {\n        'trial': state.trial,\n        'stimuli': state.stimuli[state.trial-1],\n        'choice': selected,\n        'correct': _correct,\n        'respondedAt': respondedAt,\n        'trialStartedAt': state.trialStartedAt,\n        'rt': respondedAt - state.trialStartedAt\n      }],\n      step: (feedbackDuration>0)?'feedback':'fixation'\n    })\n  }\n\n  /**\n   * Renders the given stimulus. If type is icon it uses iconFigures to render, and if type is letter it uses Typography element\n   * @param {*} stimulus \n   * @returns html element of the stimuli\n   */\n  const renderStimulus = (stimulus) => {\n    console.log('renderStimulus: ',stimulus);\n    if(stimulus===null || stimulus===undefined){\n      console.log('figure is null, state:',state);\n      return(\n        <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n        </Grid>\n      )\n    }\n    if(stimulus.type===\"icon\"){\n      if(!iconFigures[stimulus.name]){\n        return(\n          <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n            <Fragment>\n              <Box onClick={() => handleResponse(stimulus)} className='single-stimulus single-stimulus-icon'>\n                <Block fontSize='large' className='yellow single-stimulus-icon' />\n              </Box>\n            </Fragment>\n          </Grid>\n        );\n      }\n      const FigureCompoentnt = iconFigures[stimulus.name];\n      return(\n        <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n          <Box onClick={() => handleResponse(stimulus)} className='single-stimulus single-stimulus-icon'>\n            <FigureCompoentnt fontSize='large' className='yellow single-stimulus-icon' />\n          </Box>\n        </Grid>\n      );\n    }else if(stimulus.type===\"letter\"){\n      return(\n        <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n          <Box onClick={() => handleResponse(stimulus)} className='single-stimulus single-stimulus-letter' textAlign=\"center\">\n            <Typography type='span' className='yellow single-stimuli-letter'> {stimulus.name} </Typography>\n          </Box>\n        </Grid>\n      );\n    }\n  }\n\n  /**\n   * Renders feedback\n   */\n  const renderFeedback = () => {\n    return (\n      <Grid item container direction='row' justifyContent='space-around' alignItems='center'>\n        {state.correct && <Correct fontSize='large' className='correct single-stimulus-icon' />}\n        {!state.correct && <Incorrect fontSize='large' className='incorrect single-stimulus-icon' />}\n      </Grid>\n    )\n  }\n\n  /**\n   * Renders fixation element\n   */\n  const renderFixation = () => {\n    return (\n      <Grid item container direction=\"row\" justifyContent=\"space-around\" alignItems=\"center\">\n        <Add fontSize='large' className='single-stimulus-fixation single-stimulus-icon' />\n      </Grid>\n    );\n  }\n\n  // start screen\n  if (state.trial === null) {\n    return (\n      <Grid container direction='column' spacing={2} alignItems='center' justifyContent='flex-start' className='Text-container'>\n        <Grid item><Markdown source={t('gonogoalt.are_you_ready')} escapeHtml={false} className='markdown-text' /></Grid>\n        <Grid item>\n          <Button variant='outlined' onClick={() => startTask()}>{t('gonogoalt.start')}</Button>\n        </Grid>\n      </Grid>\n    )\n  }\n\n  return (\n    <Grid item container direction='column' spacing={2} alignItems='stretch' justifyContent='flex-start' className='gonogoalt-container'>\n      <Grid item>\n        <Markdown source={t(text)} escapeHtml={false} className='markdown-text' />\n      </Grid>\n      <Grid item container direction='row' justifyContent='center' alignItems='center' className='nback-main-container'>\n        {state.step === 'stimuli'  && renderStimulus(state.stimuli[state.trial-1])}\n        {state.step === 'feedback' && renderFeedback()}\n        {state.step === 'fixation' && renderFixation()}\n      </Grid>\n    </Grid>\n  );\n\n}\n","import React, {useRef, useState, useEffect} from 'react';\n\nimport {useParams,useLocation} from 'react-router-dom';\n\nimport {Container, ThemeProvider, CssBaseline, LinearProgress, Grid, Paper, Snackbar} from '@material-ui/core';\nimport {Alert} from '@material-ui/lab';\n\nimport {ltrTheme, rtlTheme} from './utils/theme';\nimport {languages} from './utils/i18n';\n\nimport Navigation from './navigation';\nimport Text from './text';\nimport Prolific from './prolific'\nimport Matrix from './matrix';\nimport Submission from './submission';\nimport BART from './bart';\nimport GoNoGo from './gonogo';\nimport Stroop from './stroop';\nimport Ultimatum from './ultimatum';\nimport Dictator from './dictator';\nimport { useTranslation } from 'react-i18next';\nimport TaskSwitch from './taskswitch';\nimport SimplifiedTaskSwitch from './simplified_taskswitch';\nimport NBack from './nback';\nimport GoNoGoAlt from './gonogoalt';\nimport ReactGA from \"react-ga4\";\n\nfunction useQuery() {\n  return new URLSearchParams(useLocation().search);\n}\n\nexport default function Study(props) {\n\n  ReactGA.initialize(\"G-YFD0H08757\");\n  const {t, i18n} = useTranslation();\n  let {lang, studyId} = useParams();\n\n  // prolific shits\n  let query = useQuery();\n\n  const theme = (languages[lang].direction === 'rtl')?rtlTheme:ltrTheme;\n  const responseIsValid = useRef(false);\n\n  const [state, setState] = useState({\n    subject: undefined,\n    session: undefined,\n    progress: 0,\n    finished: false,\n    loading: false,\n    view: {},\n    currentViewIndex: 0,\n    responses: [],\n    experiment: {}\n  })\n\n  const [notification, setNotification] = useState(undefined);\n\n  const storeData = (data, autoNext=false) => {\n    console.log('study.storeData', data);\n\n    if (autoNext) {\n      onNext();\n    }\n    \n    setState(prev => {\n      return {\n        ...prev,\n        responses: [...prev.responses, data],\n        loading: false\n      }\n    });\n  }\n\n  const updateViewProgress = (currentViewProgressPct) => {\n\n    const currentViewProgress = currentViewProgressPct  / 100.0\n\n    setState(prev => {\n      return {\n        ...prev,\n        progress: 100 * (prev.currentViewIndex + currentViewProgress) / \n                  prev.experiment.views.length\n                  \n      }\n    });\n  }\n\n  const onNext = () => {\n\n    if ((state.view.required || state.view.requiredQuestions?.length>0) && !responseIsValid.current) {\n      setNotification(t('errors.required'))\n      return;\n    }\n\n    responseIsValid.current = false;\n\n    setState(prev => {\n      const nextViewIndex = prev.currentViewIndex + 1;\n\n      if (nextViewIndex < prev.experiment.views.length) {  \n        return {\n          ...prev,\n          loading: true,\n          progress: 100 * nextViewIndex / prev.experiment.views.length,\n          view: prev.experiment.views[nextViewIndex],\n          currentViewIndex: nextViewIndex\n        }\n      } else { //finished\n        return {\n          ...prev,\n          progress: 100,\n          finished: true,\n          loading: false\n        }\n      }\n    })\n\n  }\n  \n  const renderView = (view) => {\n    \n    if (state.finished) {\n      return (\n        <Submission submission={{\n          PROLIFIC_PID: query.get('PROLIFIC_PID'),\n          STUDY_ID: query.get('STUDY_ID'),\n          SESSION_ID: query.get('SESSION_ID'),\n          startedAt: state.startedAt,\n          responses: state.responses}}\n          studyId={studyId} submissionNote={state.experiment.submissionNote} />\n      );\n    }\n\n    switch(view?.type) {\n      case 'text':\n        return <Text onStore={storeData} content={view} key={view.id} onValidate={(r) => responseIsValid.current = r} />;\n      case 'prolific':\n        return <Prolific onStore={storeData} content={view} key={view.id} onValidate={(r) => responseIsValid.current = r} />;\n      case 'bart':\n        return <BART onStore={storeData} content={view} key={view.id} />;\n      case 'gonogo': \n        return <GoNoGo onStore={storeData} onProgress={updateViewProgress} content={view} key={view.id} />;\n      case 'stroop': \n        return <Stroop onStore={storeData} content={view} key={view.id} />;\n      case 'matrix':\n        return <Matrix onStore={storeData} content={view} key={view.id} onValidate={(r) => responseIsValid.current = r} />\n      case 'ultimatum':\n        return <Ultimatum onStore={storeData} content={view} key={view.id} onNotification={setNotification} />;\n      case 'dictator':\n        return <Dictator onStore={storeData} content={view} key={view.id} onNotification={setNotification} />;\n      case 'taskswitch':\n        return <TaskSwitch onStore={storeData} onProgress={updateViewProgress} content={view} key={view.id} onNotification={setNotification} />;\n      case 'simplified_taskswitch':\n        return <SimplifiedTaskSwitch onStore={storeData} onProgress={updateViewProgress} content={view} key={view.id} onNotification={setNotification} />;\n      case 'nback':\n        return <NBack onStore={storeData} onProgress={updateViewProgress} content={view} key={view.id} onNotification={setNotification} />;\n      case 'gonogoalt':\n        return <GoNoGoAlt onStore={storeData} onProgress={updateViewProgress} content={view} key={view.id} onNotification={setNotification} />;\n      default:\n        return <div>Not Implemented!</div>;\n    }\n\n  }\n  \n  const startExperiment = (experiment) => {\n    console.log(\"starting experiment\", experiment);\n    console.log(\"prolific pid : \",query.get('PROLIFIC_PID'))\n    setState(prev => {\n      return {\n        ...prev,\n        startedAt: Date.now(),\n        experiment: experiment,\n        currentViewIndex: 0,\n        view: experiment.views[0]\n      }\n    });\n\n    if (process.env.NODE_ENV === 'production') {\n      ReactGA.send({ hitType: \"pageview\", page: window.location.pathname , title: \"window?.title\" });\n    }\n\n  }\n\n  //load experiment\n  useEffect(() => {\n    i18n.changeLanguage(lang);\n    fetch(process.env.PUBLIC_URL + `/experiments/${studyId}.json`)\n      .then(resp => resp.json())\n      .then(experiment => startExperiment(experiment));\n  },[studyId]);\n\n  //render\n  return (\n\n    <ThemeProvider theme={theme}>\n      <div dir={languages[lang].direction}>\n        <CssBaseline />\n\n        <LinearProgress variant=\"determinate\" value={state.progress} />\n\n        <Container maxWidth=\"sm\" className='study-container'>\n          <Grid container\n            spacing={2}\n            direction=\"column\"\n            justifyContent=\"flex-start\"\n            alignItems=\"stretch\"\n            className='study-grid-container'\n          >\n            <Snackbar \n              open={notification !== undefined} \n              autoHideDuration={5000} \n              onClose={() => setNotification(undefined)}\n            >\n              <Alert onClose={() => setNotification(undefined)} severity=\"error\">{t(notification)}</Alert>\n            </Snackbar>\n\n            <Grid item>\n              <Paper className='view-container'>\n              {!state.finished && state.loading && <div>{t('loading')}</div>}\n              {!state.loading && renderView(state.view)}\n              </Paper>\n            </Grid>\n            {!['gonogo','bart','stroop','ultimatum','dictator','taskswitch','simplified_taskswitch','nback','gonogoalt'].includes(state.view.type) && !state.loading &&\n            <Grid item>\n              <Navigation onNext={onNext} finished={state.finished} redirectTo={state.experiment.redirectTo} />\n            </Grid>\n            }\n          </Grid>\n        </Container>\n      </div>\n    </ThemeProvider>\n  );\n}\n","import React from 'react';\n\nexport default function About() {\n  return (\n    <div className=\"about\">\n      Hello!\n    </div>\n  );\n}\n","import React from 'react';\n\nimport {useParams, Link} from 'react-router-dom';\nimport {useTranslation} from 'react-i18next';\n\nimport {ltrTheme} from './utils/theme';\n\nimport {Grid, Paper, Button, ThemeProvider, CssBaseline, Container} from '@material-ui/core';\n\nimport Markdown from 'react-markdown/with-html';\n\nimport {languages} from './utils/i18n';\n\nimport './index.css'\n\nexport default function LanguageSelector(props) {\n\n  const { t } = useTranslation();\n  let {studyId} = useParams();\n\n\n  return (\n    <ThemeProvider theme={ltrTheme}>\n      <CssBaseline />\n\n      <Container maxWidth=\"sm\" className='study-container'>\n        <Grid item container\n          spacing={2}\n          direction=\"column\"\n          justifyContent=\"flex-start\"\n          alignItems=\"stretch\"\n        >\n          <Paper className='languages-container'>\n\n          <Markdown source={t('language_selector.text')} escapeHtml={false}  className='markdown-text' />\n          <Grid container direction='row' spacing={3} justifyContent='space-around'>\n          {Object.entries(languages).map(([key, val]) => \n            <Grid item key={key} xs={4}>\n              <Button component={Link} to={`/${studyId}/${key}`} fullWidth variant='outlined'>{val.title}</Button>\n            </Grid>\n          )}\n          </Grid>\n          </Paper>\n        </Grid>\n      </Container>\n    </ThemeProvider>\n  );\n}\n","import React from 'react';\n\nimport {\n  HashRouter as Router,\n  Switch,\n  Route,\n} from \"react-router-dom\";\n\n//main components\nimport Study from './study';\nimport About from './about';\nimport LanguageSelector from './language_selector';\n\nexport default function AppRouter() {\n  return (\n    <Router basename=\"/\">\n        <Switch>\n          <Route exact path=\"/\"><About /></Route>\n          <Route path=\"/:studyId/:lang\"><Study /></Route>\n          <Route path=\"/:studyId\"><LanguageSelector /></Route>\n          <Route path=\"/about\"><About /></Route>\n        </Switch>\n    </Router>\n  );\n}\n","import React, {Suspense} from 'react';\nimport ReactDOM from 'react-dom';\nimport i18n from './utils/i18n';\nimport AppRouter from './router';\nimport {I18nextProvider} from 'react-i18next';\n\n\n//css\nimport './index.css';\n\nReactDOM.render(\n\n  <Suspense fallback=\"loading\">\n  <I18nextProvider i18n={i18n}>\n    <AppRouter />\n  </I18nextProvider>\n  </Suspense>\n  , document.getElementById('root'));\n"],"sourceRoot":""}